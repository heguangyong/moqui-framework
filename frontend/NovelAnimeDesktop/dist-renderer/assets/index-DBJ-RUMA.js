const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./_plugin-vue_export-helper-BFgqyxDe.js","./runtime-core.esm-bundler-8-XbLWPr.js","./pinia-Be3yrKEl.js","./preload-helper-CmsKOCeN.js","./Settings-DFQEsv6e.js","./vue.runtime.esm-bundler-tGj6Om4U.js","./ViewHeader-DsFMPudV.js","./ViewHeader-dVmvsyzY.css","./useTheme-yXL8gOdE.js","./api-BR07cdPl.js","./Settings-EYiGM9Y6.css","./WorkflowEditor-C_1UNyiG.js","./workflowStore-BU4lfOfq.js","./CharacterSystem-9i6-R3qi.js","./InputDialog-CLWUPPpH.js","./InputDialog-jO_GFQKy.css","./WorkflowEditor-RcMX6pRt.css","./AssetsView-BobqhZam.js","./AssetsView-D0r1OSGR.css","./CharactersView-BPl-9BdA.js","./index-CMv62JsV.js","./novelApi-CpaaRXu-.js","./CharactersView-DRcZ0Xr6.css","./CharacterDetailView-95jXuLlX.js","./CharacterDetailView-C6NztujI.css","./ProfileView-Bbki-Jbz.js","./ProfileView-B1vJ7-Y0.css","./PreviewView-DYjBCMba.js","./PreviewView-BFqJ5m9n.css","./GeneratedContentView-ChQnmZHE.js","./GeneratedContentView-ZoZkYYYX.css"])))=>i.map(i=>d[i]);
import{_ as q}from"./preload-helper-CmsKOCeN.js";import{e as ue,c as ee,i as D,_ as W,C as $e,F as Ae,E as Ne,P as De,A as Le,g as Ee,h as xe,u as ve,d as ze,f as pe,S as Z,b as Fe,j as Te,k as Ve,l as Re,m as qe}from"./_plugin-vue_export-helper-BFgqyxDe.js";import{a as U}from"./api-BR07cdPl.js";import{n as V}from"./novelApi-CpaaRXu-.js";import{withModifiers as G,vModelText as Oe,vModelDynamic as Me}from"./vue.runtime.esm-bundler-tGj6Om4U.js";import{I as ge,d as R,r as L,C as me,j as m,k as l,l as e,s as T,F as z,z as te,p as k,u as C,v as _,x as F,y,B as he,A as Q,w as Ue,D as J,M as ce,K as We,q as ie,G as Be}from"./runtime-core.esm-bundler-8-XbLWPr.js";import"./pinia-Be3yrKEl.js";const Ge={class:"project-list-container"},He={key:0,class:"project-loading-state"},Je={key:1,class:"project-list-wrapper"},Qe={class:"project-grid"},Xe=["onClick"],Ke={class:"project-card-header"},Ye={class:"project-card-icon"},Ze={class:"project-card-actions"},et=["onClick"],tt={class:"project-card-name"},ot={class:"project-card-desc"},st={class:"project-card-footer"},at={class:"project-card-date"},lt={class:"dialog-body"},nt={key:2,class:"project-empty-state"},rt={class:"project-empty-icon"},ct=ge({__name:"ProjectList",emits:["open-project","project-deleted"],setup(v,{emit:P}){const w=P,a=ue(),S=ee(),b=R(()=>a.projects),p=R(()=>a.isLoading),j=L(!1),c=L(null);me(async()=>{console.log("ğŸ“‹ ProjectList mounted, fetching projects..."),await a.fetchProjects(),console.log("ğŸ“‹ Projects loaded:",a.projects.length),console.log("ğŸ“‹ Projects data:",JSON.stringify(a.projects,null,2));const g=a.projects.map(s=>s.id||s.projectId),h=new Set(g);g.length!==h.size&&console.warn("âš ï¸ å‘ç°é‡å¤çš„é¡¹ç›®IDï¼",g)});function f(g){return{draft:"è‰ç¨¿",processing:"å¤„ç†ä¸­",completed:"å·²å®Œæˆ",active:"è¿›è¡Œä¸­",imported:"å·²å¯¼å…¥",parsed:"å·²è§£æ",analyzing:"åˆ†æä¸­",characters_confirmed:"è§’è‰²å·²ç¡®è®¤",characters_continue:"è§’è‰²ç¡®è®¤ä¸­",generating:"ç”Ÿæˆä¸­"}[g]||g||"è‰ç¨¿"}function A(g){return g?new Date(g).toLocaleDateString("zh-CN"):""}function E(g){console.log("ğŸ“‹ ProjectList: handleProjectClick",g),w("open-project",g)}function x(g,h){g.stopPropagation(),c.value=h,j.value=!0}async function N(){if(c.value){if(!localStorage.getItem("novel_anime_access_token")){console.warn("âš ï¸ User not authenticated, cannot delete project"),S.addNotification({type:"error",title:"æœªç™»å½•",message:"è¯·å…ˆç™»å½•åå†åˆ é™¤é¡¹ç›®ã€‚åˆ é™¤æ“ä½œéœ€è¦ç”¨æˆ·è®¤è¯ã€‚",timeout:5e3}),j.value=!1,c.value=null;return}console.log("ğŸ—‘ï¸ Confirming delete for project:",c.value);const h=c.value.id||c.value.projectId;if(console.log("ğŸ—‘ï¸ Project ID to delete:",h),await a.deleteProject(h))console.log("âœ… Delete successful"),S.addNotification({type:"success",title:"åˆ é™¤æˆåŠŸ",message:`é¡¹ç›® "${c.value.name}" å·²åˆ é™¤`,timeout:2e3}),await a.fetchProjects(),w("project-deleted",h);else{console.error("âŒ Delete failed, error:",a.error);const u=a.error||"",r=u.includes("not authorized")||u.includes("No User");S.addNotification({type:"error",title:"åˆ é™¤å¤±è´¥",message:r?"æƒé™ä¸è¶³ï¼šè¯·ç¡®ä¿å·²ç™»å½•å¹¶æœ‰åˆ é™¤æƒé™":a.error||"æ— æ³•åˆ é™¤é¡¹ç›®ï¼Œè¯·é‡è¯•",timeout:5e3})}}j.value=!1,c.value=null}function $(){j.value=!1,c.value=null}return(g,h)=>(l(),m("div",Ge,[p.value?(l(),m("div",He,[...h[1]||(h[1]=[e("div",{class:"project-loading-spinner"},null,-1),e("span",null,"åŠ è½½ä¸­...",-1)])])):b.value.length>0?(l(),m("div",Je,[e("div",Qe,[(l(!0),m(z,null,te(b.value,(s,u)=>(l(),m("div",{key:s.id||s.projectId||`project-${u}`,class:"project-card-item",onClick:r=>E(s)},[e("div",Ke,[e("div",Ye,[(l(),k(C(_(D).folder),{size:20}))]),e("div",Ze,[e("button",{class:"project-delete-btn",onClick:G(r=>x(r,s),["stop"]),title:"åˆ é™¤é¡¹ç›®"},[(l(),k(C(_(D).trash),{size:16}))],8,et)]),e("div",{class:F(["project-status-badge",`project-status-badge--${s.status||"draft"}`])},y(f(s.status)),3)]),e("div",tt,y(s.name||"æœªå‘½åé¡¹ç›®"),1),e("div",ot,y(s.description||"æš‚æ— æè¿°"),1),e("div",st,[e("span",at,y(A(s.updatedAt||s.createdAt)),1)])],8,Xe))),128))]),j.value?(l(),m("div",{key:0,class:"modal-overlay",onClick:$},[e("div",{class:"confirm-dialog",onClick:h[0]||(h[0]=G(()=>{},["stop"]))},[h[2]||(h[2]=e("div",{class:"dialog-header"},[e("h3",null,"ç¡®è®¤åˆ é™¤")],-1)),e("div",lt,[e("p",null,'ç¡®å®šè¦åˆ é™¤é¡¹ç›® "'+y(c.value?.name)+'" å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚',1)]),e("div",{class:"dialog-footer"},[e("button",{class:"btn btn-secondary",onClick:$},"å–æ¶ˆ"),e("button",{class:"btn btn-danger",onClick:N},"åˆ é™¤")])])])):T("",!0)])):(l(),m("div",nt,[e("div",rt,[(l(),k(C(_(D).folder),{size:48}))]),h[3]||(h[3]=e("div",{class:"project-empty-title"},"æš‚æ— é¡¹ç›®",-1)),h[4]||(h[4]=e("div",{class:"project-empty-desc"},"è¿”å›ä»ªè¡¨ç›˜åˆ›å»ºæ‚¨çš„ç¬¬ä¸€ä¸ªé¡¹ç›®",-1))]))]))}}),it=W(ct,[["__scopeId","data-v-478451b5"]]),dt={class:"workflow-guide"},ut={class:"steps-container"},vt=["onClick"],pt={key:1},gt={class:"step-content"},mt={class:"step-icon"},ht={class:"step-info"},ft={class:"step-title"},wt={class:"step-description"},jt={class:"step-action"},_t=["onClick","disabled"],yt={key:1,class:"step-btn-placeholder"},bt={key:0,class:"import-progress-section"},It={class:"progress-header"},kt={class:"progress-message"},Pt={class:"progress-percent"},St={class:"progress-bar-container"},Ct={key:1,class:"import-error"},$t={__name:"WorkflowSteps",props:{steps:{type:Array,required:!0},currentStep:{type:Number,required:!0},isImporting:{type:Boolean,default:!1},importProgress:{type:Number,default:0},importMessage:{type:String,default:""},importError:{type:String,default:""}},emits:["step-click","step-action"],setup(v,{emit:P}){const w=P;function a(p,j){(p.enabled||p.completed)&&w("step-click",{step:p,index:j})}function S(p){w("step-action",p)}function b(p){return p.completed&&{import:"é‡æ–°å¯¼å…¥",parse:"é‡æ–°è§£æ",characters:"æŸ¥çœ‹è§’è‰²",generate:"æŸ¥çœ‹ç»“æœ"}[p.id]||p.actionLabel}return(p,j)=>(l(),m("div",dt,[j[0]||(j[0]=e("h3",{class:"section-title"},"å¿«é€Ÿå¼€å§‹",-1)),e("div",ut,[(l(!0),m(z,null,te(v.steps,(c,f)=>(l(),m("div",{key:c.id,class:F(["step-card",{"step-card--active":v.currentStep===f,"step-card--completed":c.completed,"step-card--disabled":!c.enabled}]),onClick:A=>a(c,f)},[e("div",{class:F(["step-number",{"step-number--completed":c.completed}])},[c.completed?(l(),k(C(void 0),{key:0,size:14})):(l(),m("span",pt,y(f+1),1))],2),e("div",gt,[e("div",mt,[(l(),k(C(c.icon),{size:24}))]),e("div",ht,[e("h4",ft,y(c.title),1),e("p",wt,y(c.description),1)])]),e("div",jt,[c.actionLabel&&(v.currentStep===f||c.completed)?(l(),m("button",{key:0,class:F(["step-btn",{"step-btn--primary":v.currentStep===f&&!c.completed,"step-btn--completed":c.completed}]),onClick:G(A=>S(c),["stop"]),disabled:!c.enabled||v.isImporting},y(b(c)),11,_t)):c.actionLabel?(l(),m("span",yt,y(c.actionLabel),1)):T("",!0)])],10,vt))),128))]),v.isImporting?(l(),m("div",bt,[e("div",It,[e("span",kt,y(v.importMessage),1),e("span",Pt,y(v.importProgress)+"%",1)]),e("div",St,[e("div",{class:"progress-bar-fill",style:he({width:v.importProgress+"%"})},null,4)])])):T("",!0),v.importError?(l(),m("div",Ct,[(l(),k(C(void 0),{size:16})),e("span",null,y(v.importError),1)])):T("",!0)]))}},At=W($t,[["__scopeId","data-v-f61169ae"]]),Nt={key:0,class:"active-project-section"},Dt={class:"project-info"},Lt={class:"project-details"},Et={class:"project-progress"},xt={__name:"ProjectOverview",props:{project:{type:Object,required:!0}},emits:["continue","view-results","new-project"],setup(v,{emit:P}){const w={folder:Ae,check:$e,eye:Ne,plus:De,arrowRight:Le},a=P;function S(c){return{active:"è¿›è¡Œä¸­",importing:"å¯¼å…¥ä¸­",imported:"å·²å¯¼å…¥",analyzing:"åˆ†æä¸­",analyzed:"å·²åˆ†æ",parsing:"è§£æä¸­",parsed:"å·²è§£æ",characters_confirmed:"è§’è‰²å·²ç¡®è®¤",characters_continue:"è§’è‰²ç¡®è®¤ä¸­",generating:"ç”Ÿæˆä¸­",completed:"å·²å®Œæˆ"}[c]||c||"è¿›è¡Œä¸­"}function b(){a("continue")}function p(){a("view-results")}function j(){a("new-project")}return(c,f)=>v.project?(l(),m("div",Nt,[f[3]||(f[3]=e("h3",{class:"section-title"},"å½“å‰é¡¹ç›®",-1)),e("div",{class:F(["active-project-card",{"active-project-card--completed":v.project.status==="completed"}])},[e("div",Dt,[e("div",{class:F(["project-icon",{"project-icon--completed":v.project.status==="completed"}])},[(l(),k(C(v.project.status==="completed"?w.check:w.folder),{size:24}))],2),e("div",Lt,[e("h4",null,y(v.project.name),1),e("p",null,y(S(v.project.status))+" Â· "+y(v.project.progress)+"% å®Œæˆ",1)])]),e("div",Et,[e("div",{class:F(["progress-bar",{"progress-bar--completed":v.project.status==="completed"}])},[e("div",{class:F(["progress-fill",{"progress-fill--completed":v.project.status==="completed"}]),style:he({width:v.project.progress+"%"})},null,6)],2)]),v.project.status==="completed"?(l(),m(z,{key:0},[e("button",{class:"continue-btn continue-btn--success",onClick:p},[f[0]||(f[0]=Q(" æŸ¥çœ‹ç»“æœ ",-1)),(l(),k(C(w.eye),{size:16}))]),e("button",{class:"continue-btn continue-btn--secondary",onClick:j},[f[1]||(f[1]=Q(" æ–°å»ºé¡¹ç›® ",-1)),(l(),k(C(w.plus),{size:16}))])],64)):(l(),m("button",{key:1,class:"continue-btn",onClick:b},[f[2]||(f[2]=Q(" ç»§ç»­å¤„ç† ",-1)),(l(),k(C(w.arrowRight),{size:16}))]))],2)])):T("",!0)}},zt=W(xt,[["__scopeId","data-v-8835ab0c"]]),Ft={key:0,class:"recent-projects-section"},Tt={class:"project-list"},Vt=["onClick"],Rt={class:"project-icon-small"},qt={class:"project-item-info"},Ot={class:"project-name"},Mt={class:"project-date"},Ut={__name:"QuickActions",props:{projects:{type:Array,required:!0,default:()=>[]}},emits:["open-project"],setup(v,{emit:P}){const w={fileText:Ee,chevronRight:xe},a=P;function S(p){if(!p)return"";const j=new Date(p),f=new Date-j;return f<864e5?"ä»Šå¤©":f<1728e5?"æ˜¨å¤©":j.toLocaleDateString("zh-CN",{month:"short",day:"numeric"})}function b(p){a("open-project",p)}return(p,j)=>v.projects.length>0?(l(),m("div",Ft,[j[0]||(j[0]=e("h3",{class:"section-title"},"æœ€è¿‘é¡¹ç›®",-1)),e("div",Tt,[(l(!0),m(z,null,te(v.projects,c=>(l(),m("div",{key:c.id,class:"project-item",onClick:f=>b(c)},[e("div",Rt,[(l(),k(C(w.fileText),{size:16}))]),e("div",qt,[e("span",Ot,y(c.name),1),e("span",Mt,y(S(c.updatedAt)),1)]),(l(),k(C(w.chevronRight),{size:16,class:"project-arrow"}))],8,Vt))),128))])])):T("",!0)}},de=W(Ut,[["__scopeId","data-v-24534e6c"]]),Wt={class:"dashboard-view"},Bt={class:"content-placeholder"},Gt={key:1,class:"content-placeholder"},Ht={class:"content-placeholder"},Jt={class:"status-section"},Qt={class:"status-grid"},Xt={class:"status-item status-item--ok"},Kt={__name:"DashboardView",setup(v){const P=ve(),w=ze(),a=ue(),S=ee();pe();const b=R(()=>w.panelContext.dashboard),p=R(()=>b.value?.viewType),j=R(()=>b.value?.selectedProject),c=R(()=>b.value?.statusFilter),f=R(()=>b.value?.shortcutType),A=L(0),E=L(!1),x=L(!1),N=L(!1),$=L(0),g=L(""),h=L(""),s=L(null),u=L([{id:"import",title:"å¯¼å…¥å°è¯´",description:"æ”¯æŒ TXTã€DOCXã€PDF æ ¼å¼çš„å°è¯´æ–‡ä»¶ï¼Œæˆ–ç›´æ¥ç²˜è´´æ–‡æœ¬",icon:D.upload,actionLabel:"é€‰æ‹©æ–‡ä»¶",action:"import",enabled:!0,completed:!1},{id:"parse",title:"æ™ºèƒ½è§£æ",description:"è‡ªåŠ¨è¯†åˆ«ç« èŠ‚ç»“æ„ï¼Œåˆ†ææ–‡æœ¬å†…å®¹",icon:D.search,actionLabel:"å¼€å§‹è§£æ",action:"parse",enabled:!1,completed:!1},{id:"characters",title:"è§’è‰²ç¡®è®¤",description:"å®¡æ ¸å’Œç¼–è¾‘ AI è¯†åˆ«å‡ºçš„è§’è‰²ä¿¡æ¯",icon:D.users,actionLabel:"æŸ¥çœ‹è§’è‰²",action:"characters",enabled:!1,completed:!1},{id:"generate",title:"ç”ŸæˆåŠ¨æ¼«",description:"é…ç½®å·¥ä½œæµå‚æ•°ï¼Œå¼€å§‹ç”ŸæˆåŠ¨æ¼«å†…å®¹",icon:D.play,actionLabel:"å¼€å§‹ç”Ÿæˆ",action:"generate",enabled:!1,completed:!1}]),r=L(null),B=R(()=>a.recentProjects?.slice(0,5)||[]);Ue(b,t=>{console.log("ğŸ‘€ Dashboard panelContext changed:",JSON.stringify(t))},{deep:!0,immediate:!0}),me(async()=>{console.log("ğŸ“Š DashboardView mounted");const t=localStorage.getItem("novel_anime_access_token");console.log("ğŸ” Auth token:",t?"Present âœ…":"Missing âŒ"),t||(console.warn("âš ï¸ User not authenticated - some operations (like delete) may fail"),S.addNotification({type:"warning",title:"æç¤º",message:"å½“å‰æœªç™»å½•ï¼Œéƒ¨åˆ†åŠŸèƒ½ï¼ˆå¦‚åˆ é™¤é¡¹ç›®ï¼‰éœ€è¦ç™»å½•åä½¿ç”¨",timeout:5e3})),await X(),await H()});async function X(){try{E.value=await U.testConnection(),console.log("ğŸ”Œ Backend status:",E.value?"Connected":"Disconnected"),E.value?x.value=await U.testAIService():x.value=!1,console.log("ğŸ¤– AI service status:",x.value?"Available":"Configuring")}catch(t){console.warn("Failed to check system status:",t),E.value=!1,x.value=!1}}async function H(){if(!a.currentProject){console.log("ğŸ“Š No current project, skipping project load"),r.value=null,s.value=null,u.value.forEach((o,d)=>{o.completed=!1,o.enabled=d===0}),A.value=0;return}let t=a.currentProject;if(!t)try{const o=await U.getProjects();o.success&&o.projects&&o.projects.length>0&&(t=o.projects.find(d=>d.status!=="completed")||o.projects[0],t&&a.setCurrentProject(t))}catch(o){console.warn("Failed to load projects from API:",o)}if(t){const o=t.id||t.projectId;if(await a.fetchProjects(),!a.projects.find(n=>(n.id||n.projectId)===o)){console.warn("âš ï¸ Current project no longer exists (deleted), clearing..."),a.clearCurrentProject(),r.value=null,s.value=null,Z.cleanupProjectData(o),u.value.forEach((i,I)=>{i.completed=!1,i.enabled=I===0}),A.value=0;const n=a.projects[0];if(n)console.log("ğŸ”„ Loading next available project:",n.name),t=n,a.setCurrentProject(t);else{console.log("ğŸ“Š No projects available");return}}if(o)try{console.log("ğŸ“Š Fetching latest project status from backend for:",o);const n=await U.axiosInstance.get(`/project/${o}`);n.data&&n.data.project&&(t={...t,...n.data.project,id:o},console.log("ğŸ“Š Got latest project from backend:",t),a.setCurrentProject(t))}catch(n){console.warn("Failed to fetch latest project status, using cached data:",n)}if(r.value={...t,id:o},o)try{console.log("ğŸ“š Loading novels for project:",o);const n=await V.listNovels(o);console.log("ğŸ“š Novels result:",n),n.success&&n.novels&&n.novels.length>0&&(s.value=n.novels[0].novelId,console.log("ğŸ“š Loaded novelId from project:",s.value))}catch(n){console.warn("Failed to load novels for project:",n)}s.value||Z.validateProjectData(o)||(console.warn("âš ï¸ Session data does not match current project, cleaning up..."),Z.cleanupProjectData(o),console.log("âœ… Old session data cleared, starting fresh")),oe(r.value)}console.log("ğŸ“Š Active project loaded:",r.value,"novelId:",s.value)}function oe(t){if(!t)return;const d={active:1,importing:0,imported:1,analyzing:1,analyzed:2,parsing:1,parsed:2,characters_confirmed:3,generating:3,completed:4}[t.status]??0;u.value.forEach((n,i)=>{n.completed=i<d,n.enabled=i<=d}),A.value=Math.min(d,u.value.length-1)}function fe({step:t,index:o}){(t.enabled||t.completed)&&(A.value=o)}function we(t){switch(t.action){case"import":je();break;case"parse":Ie();break;case"characters":le();break;case"generate":t.completed?ne():(w.updatePanelContext("workflow",{viewType:"template",templateId:"t1",selectedWorkflow:null,statusFilter:null,executionId:null}),P.push("/workflow"));break}}async function je(){if(console.log("ğŸ“‚ importNovel called, electronAPI:",!!window.electronAPI),window.electronAPI&&window.electronAPI.openFile)try{console.log("ğŸ–¥ï¸ Using Electron file dialog");const t=await window.electronAPI.openFile({filters:[{name:"å°è¯´æ–‡ä»¶",extensions:["txt","docx","pdf","epub","md"]}]});t&&(console.log("ğŸ“„ File selected:",t),await _e(t))}catch(t){console.error("Electron file dialog failed:",t),se()}else console.log("ğŸŒ Using HTML file input"),se()}function se(){const t=document.createElement("input");t.type="file",t.accept=".txt,.docx,.pdf,.epub,.md",t.onchange=async o=>{const d=o.target.files[0];d&&(console.log("ğŸ“„ File selected via input:",d.name),await ye(d))},t.click()}async function _e(t){N.value=!0,$.value=10,g.value="æ­£åœ¨è¯»å–æ–‡ä»¶...",h.value="";try{const o=await window.electronAPI.readFile(t),d=t.split("/").pop()||t.split("\\").pop(),n=d.replace(/\.[^/.]+$/,"");$.value=30,g.value="æ­£åœ¨ä¸Šä¼ åˆ°æœåŠ¡å™¨...",await ae(n,o,d)}catch(o){console.error("Failed to read file:",o),h.value="è¯»å–æ–‡ä»¶å¤±è´¥: "+o.message,N.value=!1}}async function ye(t){N.value=!0,$.value=10,g.value="æ­£åœ¨è¯»å–æ–‡ä»¶...",h.value="";try{const o=await be(t),d=t.name.replace(/\.[^/.]+$/,"");$.value=30,g.value="æ­£åœ¨ä¸Šä¼ åˆ°æœåŠ¡å™¨...",await ae(d,o,t.name)}catch(o){console.error("Failed to read file:",o),h.value="è¯»å–æ–‡ä»¶å¤±è´¥: "+o.message,N.value=!1}}function be(t){return new Promise((o,d)=>{const n=new FileReader;n.onload=i=>o(i.target.result),n.onerror=()=>d(new Error("Failed to read file")),n.readAsText(t)})}async function ae(t,o,d){try{let n=a.currentProject?.id||a.currentProject?.projectId,i=a.currentProject;if(!n){g.value="æ­£åœ¨åˆ›å»ºé¡¹ç›®...";let M=t;const Y=await U.getProjects();if(Y.success&&Y.projects){const re=Y.projects.filter(O=>O.name&&O.name.startsWith(t)).map(O=>O.name);if(re.length>0){let O=2;for(;re.includes(`${t} (${O})`);)O++;M=`${t} (${O})`,console.log(`âš ï¸ é¡¹ç›®åç§°é‡å¤ï¼Œè‡ªåŠ¨é‡å‘½åä¸º: ${M}`)}}if(console.log("ğŸ“ DashboardView: Creating project via store:",M),i=await a.createProject({name:M,description:`ä»æ–‡ä»¶ ${d} å¯¼å…¥çš„å°è¯´é¡¹ç›®`}),i){if(n=i.projectId||i.id,!n)throw new Error("åç«¯æœªè¿”å›æœ‰æ•ˆçš„é¡¹ç›®IDï¼Œæ— æ³•ç»§ç»­å¯¼å…¥");console.log("âœ… Backend returned projectId:",n),console.log("âœ… Project created successfully with backend projectId:",n,"name:",M)}else throw new Error(a.error||"åˆ›å»ºé¡¹ç›®å¤±è´¥ï¼Œæ— æ³•å¯¼å…¥å°è¯´")}if(!n)throw new Error("é¡¹ç›®IDæ— æ•ˆï¼Œæ— æ³•å¯¼å…¥å°è¯´");console.log("ğŸ“¤ Importing novel with projectId:",n),$.value=50,g.value="æ­£åœ¨å¯¼å…¥å°è¯´...";const I=await V.importText({projectId:n,title:t,content:o});if(I.success&&I.novel){s.value=I.novel.novelId,localStorage.setItem("novel_anime_current_novel_id",I.novel.novelId),localStorage.setItem("novel_anime_current_novel_title",t);const M={id:I.novel.novelId,title:t,author:I.novel.author||"æœªçŸ¥ä½œè€…",chapters:I.novel.chapters||[],metadata:{wordCount:o.length,language:"zh"},createdDate:new Date().toISOString(),lastUpdated:new Date().toISOString()};localStorage.setItem(`novel_${I.novel.novelId}`,JSON.stringify(M)),console.log("ğŸ“š å°è¯´æ•°æ®å·²å­˜å‚¨åˆ° localStorage:",I.novel.novelId),$.value=100,g.value="å¯¼å…¥æˆåŠŸï¼",u.value[0].completed=!0,u.value[1].enabled=!0,A.value=1,r.value={...i,id:n,name:t,status:"imported"},setTimeout(()=>{N.value=!1,$.value=0,g.value=""},1500)}else throw new Error(I.message||"å¯¼å…¥å¤±è´¥")}catch(n){console.error("Upload failed:",n),h.value="å°è¯´å¯¼å…¥å¤±è´¥: "+(n.message||"æœªçŸ¥é”™è¯¯"),N.value=!1}}async function Ie(){if(!s.value&&r.value)try{const t=r.value.id||r.value.projectId;if(console.log("ğŸ“š startParsing: Loading novels for project:",t),t){const o=await V.listNovels(t);o.success&&o.novels&&o.novels.length>0&&(s.value=o.novels[0].novelId,console.log("ğŸ“š startParsing: Loaded novelId:",s.value))}}catch(t){console.warn("Failed to load novelId in startParsing:",t)}if(!s.value){h.value="è¯·å…ˆå¯¼å…¥å°è¯´";return}N.value=!0,$.value=10,g.value="æ­£åœ¨åˆ†æç« èŠ‚ç»“æ„...",h.value="";try{const t=await V.analyzeStructure(s.value);if(!t.success)throw new Error(t.message||"ç»“æ„åˆ†æå¤±è´¥");$.value=50,g.value="æ­£åœ¨æå–è§’è‰²ä¿¡æ¯...";const o=await U.axiosInstance.post("/novels/extract-characters",{novelId:s.value});$.value=100,g.value="è§£æå®Œæˆï¼";try{const d=await V.getNovel(s.value);if(d.success&&d.novel){const n=localStorage.getItem(`novel_${s.value}`);if(n){const i=JSON.parse(n);i.chapters=d.novel.chapters||[],i.lastUpdated=new Date().toISOString(),localStorage.setItem(`novel_${s.value}`,JSON.stringify(i)),console.log("ğŸ“š å·²æ›´æ–° localStorage ä¸­çš„ç« èŠ‚æ•°æ®:",i.chapters.length,"ç« ")}else{const i={id:s.value,title:d.novel.title||localStorage.getItem("novel_anime_current_novel_title")||"æœªå‘½åå°è¯´",author:d.novel.author||"æœªçŸ¥ä½œè€…",chapters:d.novel.chapters||[],metadata:{wordCount:d.novel.wordCount||0,language:"zh"},createdDate:new Date().toISOString(),lastUpdated:new Date().toISOString()};localStorage.setItem(`novel_${s.value}`,JSON.stringify(i)),console.log("ğŸ“š å·²åˆ›å»º localStorage ä¸­çš„å°è¯´æ•°æ®:",i.chapters.length,"ç« ")}}}catch(d){console.warn("è·å–ç« èŠ‚æ•°æ®å¤±è´¥ï¼Œå·¥ä½œæµå¯èƒ½ä½¿ç”¨æ¨¡æ‹Ÿæ•°æ®:",d)}u.value[0].completed=!0,u.value[1].completed=!0,u.value[2].enabled=!0,A.value=2,r.value&&(r.value.status="parsed"),setTimeout(()=>{N.value=!1,$.value=0,g.value=""},1500)}catch(t){console.error("Parsing failed:",t),h.value="è§£æå¤±è´¥: "+(t.message||"æœªçŸ¥é”™è¯¯"),N.value=!1}}async function le(){if(console.log("ğŸ‘¥ viewCharacters called, currentNovelId:",s.value),!s.value&&a.currentProject)try{const t=a.currentProject.id||a.currentProject.projectId;if(console.log("ğŸ“š Trying to load novelId for project:",t),t){const o=await V.listNovels(t);console.log("ğŸ“š listNovels result:",o),o.success&&o.novels&&o.novels.length>0&&(s.value=o.novels[0].novelId,console.log("ğŸ“š Loaded novelId for characters:",s.value))}}catch(t){console.warn("Failed to load novelId:",t)}if(!s.value){const t=localStorage.getItem("novel_anime_current_novel_id");t&&(s.value=t,console.log("ğŸ“š Restored novelId from localStorage for characters:",s.value))}s.value?(w.updatePanelContext("characters",{novelId:s.value}),console.log("ğŸ‘¥ Navigating to characters with novelId:",s.value)):console.warn("âš ï¸ No novelId available for characters page"),P.push("/characters")}async function ne(){if(console.log("ğŸ‘ï¸ viewResults called"),!s.value&&r.value)try{const t=r.value.id||r.value.projectId;if(t){const o=await V.listNovels(t);o.success&&o.novels&&o.novels.length>0&&(s.value=o.novels[0].novelId)}}catch(t){console.warn("Failed to load novelId:",t)}if(s.value&&localStorage.setItem("novel_anime_current_novel_id",s.value),r.value){const t=r.value.id||r.value.projectId;t&&localStorage.setItem("novel_anime_current_project_id",t)}P.push("/generated")}function ke(){console.log("â• startNewProject called"),a.setCurrentProject(null),r.value=null,s.value=null,u.value.forEach((t,o)=>{t.completed=!1,t.enabled=o===0}),A.value=0,localStorage.removeItem("novel_anime_current_novel_id"),localStorage.removeItem("novel_anime_current_novel_title")}async function Pe(){if(console.log("ğŸ”„ continueProject called, activeProject:",r.value),!r.value){console.warn("No active project found");return}if(!s.value)try{const i=r.value.id||r.value.projectId;if(console.log("ğŸ“š Loading novels for project:",i),i){const I=await V.listNovels(i);I.success&&I.novels&&I.novels.length>0&&(s.value=I.novels[0].novelId,console.log("ğŸ“š Loaded novelId:",s.value))}}catch(i){console.warn("Failed to load novelId:",i)}const t=r.value.status||"imported";console.log("ğŸ“Š Project status:",t);const d={active:1,importing:0,imported:1,analyzing:1,analyzed:2,parsing:1,parsed:2,characters_confirmed:3,generating:3,completed:3}[t]??1;console.log("ğŸ¯ Target step:",d),A.value=d,u.value.forEach((i,I)=>{i.completed=I<d,i.enabled=I<=d});const n=document.querySelector(".workflow-guide");n&&n.scrollIntoView({behavior:"smooth",block:"start"}),d===2&&s.value?await le():d===3&&(w.updatePanelContext("workflow",{viewType:"template",templateId:"t1",selectedWorkflow:null,statusFilter:null,executionId:null,projectId:r.value.id||r.value.projectId,novelId:s.value,projectName:r.value.name}),P.push("/workflow"))}async function K(t){console.log("ğŸ“‚ openProject called:",t);const o=t.id||t.projectId;let d={...t};if(o)try{console.log("ğŸ“‚ Fetching latest project status from backend...");const i=await U.axiosInstance.get(`/project/${o}`);i.data&&i.data.project&&(d={...t,...i.data.project,id:o},console.log("ğŸ“‚ Got latest project from backend:",d))}catch(i){console.warn("Failed to fetch latest project status, using cached data:",i)}if(a.setCurrentProject(d),r.value={...d,id:o},o)try{console.log("ğŸ“š Loading novels for project:",o);const i=await V.listNovels(o);console.log("ğŸ“š Novels result:",i),i.success&&i.novels&&i.novels.length>0&&(s.value=i.novels[0].novelId,console.log("ğŸ“š Loaded novelId:",s.value),localStorage.setItem("novel_anime_current_novel_id",i.novels[0].novelId),i.novels[0].title&&localStorage.setItem("novel_anime_current_novel_title",i.novels[0].title))}catch(i){console.warn("Failed to load novels for project:",i)}oe(r.value),w.updatePanelContext("dashboard",{selectedProject:null,viewType:null,statusFilter:null,historyType:null});const n=document.querySelector(".workflow-guide");n&&n.scrollIntoView({behavior:"smooth",block:"start"}),console.log("ğŸ“‚ Project opened, status:",r.value.status,"progress:",r.value.progress)}async function Se(t){console.log("ğŸ—‘ï¸ handleProjectDeleted called for projectId:",t),r.value&&(r.value.id===t||r.value.projectId===t)&&(console.log("ğŸ”„ Deleted project was active project, clearing and reloading..."),r.value=null,s.value=null,u.value.forEach((o,d)=>{o.completed=!1,o.enabled=d===0}),A.value=0,await H())}const Ce={setup(){return()=>ce("div",{class:"content-placeholder"},[ce("span","å¤„ç†ä¸­çš„ä»»åŠ¡åˆ—è¡¨")])}};return(t,o)=>(l(),m("div",Wt,[p.value==="status"&&c.value==="running"?(l(),m(z,{key:0},[o[0]||(o[0]=e("div",{class:"view-header"},[e("h2",null,"è¿›è¡Œä¸­"),e("p",null,"æ­£åœ¨å¤„ç†çš„ä»»åŠ¡")],-1)),J(Ce)],64)):p.value==="status"&&c.value==="completed"?(l(),m(z,{key:1},[o[3]||(o[3]=e("div",{class:"view-header"},[e("h2",null,"å·²å®Œæˆ"),e("p",null,"å·²å®Œæˆçš„ä»»åŠ¡")],-1)),e("div",Bt,[(l(),k(C(_(D).check),{size:48})),o[1]||(o[1]=e("span",null,"å·²å®Œæˆä»»åŠ¡åˆ—è¡¨",-1)),o[2]||(o[2]=e("p",null,"è¿™é‡Œå°†æ˜¾ç¤ºæ‰€æœ‰å·²å®Œæˆçš„ä»»åŠ¡",-1))])],64)):p.value==="shortcut"&&f.value==="recent"?(l(),m(z,{key:2},[o[5]||(o[5]=e("div",{class:"view-header"},[e("h2",null,"æœ€è¿‘æ‰“å¼€"),e("p",null,"æ‚¨æœ€è¿‘æ‰“å¼€çš„é¡¹ç›®å’Œæ–‡ä»¶")],-1)),B.value.length>0?(l(),k(de,{key:0,projects:B.value,onOpenProject:K},null,8,["projects"])):(l(),m("div",Gt,[(l(),k(C(_(D).clock),{size:48})),o[4]||(o[4]=e("span",null,"æš‚æ— æœ€è¿‘æ‰“å¼€çš„é¡¹ç›®",-1))]))],64)):p.value==="shortcut"&&f.value==="favorites"?(l(),m(z,{key:3},[o[8]||(o[8]=e("div",{class:"view-header"},[e("h2",null,"æ”¶è—"),e("p",null,"æ‚¨æ”¶è—çš„é¡¹ç›®å’Œæ–‡ä»¶")],-1)),e("div",Ht,[(l(),k(C(_(D).star),{size:48})),o[6]||(o[6]=e("span",null,"æš‚æ— æ”¶è—",-1)),o[7]||(o[7]=e("p",null,"ç‚¹å‡»é¡¹ç›®å³ä¾§çš„æ˜Ÿæ ‡å¯æ·»åŠ æ”¶è—",-1))])],64)):p.value==="project"&&j.value==="library"?(l(),m(z,{key:4},[o[9]||(o[9]=e("div",{class:"view-header"},[e("h2",null,"å…¨éƒ¨é¡¹ç›®"),e("p",null,"ç®¡ç†æ‚¨çš„æ‰€æœ‰é¡¹ç›®")],-1)),J(it,{onOpenProject:K,onProjectDeleted:Se})],64)):(l(),m(z,{key:5},[o[12]||(o[12]=e("div",{class:"dashboard-header"},[e("h1",null,"å°è¯´åŠ¨æ¼«ç”Ÿæˆå™¨"),e("p",null,"å°†æ‚¨çš„å°è¯´è½¬æ¢ä¸ºç²¾å½©åŠ¨æ¼«ï¼Œåªéœ€å››æ­¥")],-1)),J(At,{steps:u.value,"current-step":A.value,"is-importing":N.value,"import-progress":$.value,"import-message":g.value,"import-error":h.value,onStepClick:fe,onStepAction:we},null,8,["steps","current-step","is-importing","import-progress","import-message","import-error"]),r.value?(l(),k(zt,{key:0,project:r.value,onContinue:Pe,onViewResults:ne,onNewProject:ke},null,8,["project"])):T("",!0),J(de,{projects:B.value,onOpenProject:K},null,8,["projects"]),e("div",Jt,[o[11]||(o[11]=e("h3",{class:"section-title"},"ç³»ç»ŸçŠ¶æ€",-1)),e("div",Qt,[e("div",{class:F(["status-item",{"status-item--ok":E.value}])},[(l(),k(C(E.value?_(D).check:_(D).x),{size:14})),e("span",null,"åç«¯æœåŠ¡"+y(E.value?"å·²è¿æ¥":"æœªè¿æ¥"),1)],2),e("div",Xt,[(l(),k(C(_(D).check),{size:14})),o[10]||(o[10]=e("span",null,"å‰ç«¯åº”ç”¨æ­£å¸¸",-1))]),e("div",{class:F(["status-item",{"status-item--ok":x.value}])},[(l(),k(C(x.value?_(D).check:_(D).alertCircle),{size:14})),e("span",null,"AIæœåŠ¡"+y(x.value?"å¯ç”¨":"é…ç½®ä¸­"),1)],2)])])],64))]))}},Yt=W(Kt,[["__scopeId","data-v-47387f32"]]),Zt={class:"login-view"},eo={class:"login-container"},to={class:"login-card"},oo={class:"form-group"},so={class:"form-group"},ao={class:"password-input"},lo=["type"],no={key:0,class:"error-message"},ro=["disabled"],co={class:"oauth-section"},io={class:"oauth-buttons"},uo=["disabled"],vo=["disabled"],po={class:"version-info"},go={class:"wechat-dialog"},mo={class:"dialog-content"},ho={key:0,class:"qrcode-container"},fo=["src"],wo={key:1,class:"loading"},jo={class:"status-text"},_o=ge({__name:"LoginView",setup(v){const P=ve(),w=Fe(),a=pe(),S=Te(),b=ee(),p=L({username:"john.doe",password:"moqui"}),j=L(!1),c=L(!1);let f=null;const A=R(()=>{switch(a.wechatLoginStatus){case"waiting":return"è¯·ä½¿ç”¨å¾®ä¿¡æ‰«æäºŒç»´ç ";case"scanned":return"å·²æ‰«æï¼Œè¯·åœ¨æ‰‹æœºä¸Šç¡®è®¤";case"confirmed":return"ç™»å½•æˆåŠŸï¼";case"expired":return"äºŒç»´ç å·²è¿‡æœŸï¼Œè¯·åˆ·æ–°";case"error":return"å‡ºé”™äº†ï¼Œè¯·é‡è¯•";default:return"åŠ è½½ä¸­..."}}),E=async()=>{if(a.clearError(),S.clearError(),!p.value.username||!p.value.password){b.addNotification({type:"warning",title:"è¡¨å•éªŒè¯",message:"è¯·å¡«å†™ç”¨æˆ·å/é‚®ç®±å’Œå¯†ç "});return}const s=await S.login(p.value.username,p.value.password);if(s.success){const{useNavigationStore:u}=await q(async()=>{const{useNavigationStore:X}=await import("./_plugin-vue_export-helper-BFgqyxDe.js").then(H=>H.q);return{useNavigationStore:X}},__vite__mapDeps([0,1,2,3]),import.meta.url),r=u();r.setActiveNav("dashboard"),r.resetPanelContext("dashboard"),b.addNotification({type:"success",title:"ç™»å½•æˆåŠŸ",message:`æ¬¢è¿å›æ¥ï¼Œ${S.displayName}ï¼`});const B=w.query.redirect||"/dashboard";P.push(B)}else b.addNotification({type:"error",title:"ç™»å½•å¤±è´¥",message:s.error||"è¯·æ£€æŸ¥ç”¨æˆ·å/é‚®ç®±å’Œå¯†ç "})},x=async()=>{const s=await a.getGoogleAuthUrl();s.success&&s.authUrl?(b.addNotification({type:"info",title:"Google ç™»å½•",message:"æ­£åœ¨è·³è½¬åˆ° Google æˆæƒé¡µé¢..."}),window.location.href=s.authUrl):b.addNotification({type:"error",title:"Google ç™»å½•å¤±è´¥",message:s.error||"æ— æ³•è·å–æˆæƒé“¾æ¥"})},N=async()=>{c.value=!0;const s=await a.initiateWeChatLogin();s.success?$():b.addNotification({type:"error",title:"å¾®ä¿¡ç™»å½•å¤±è´¥",message:s.error||"æ— æ³•è·å–äºŒç»´ç "})},$=()=>{g(),f=setInterval(async()=>{const s=await a.checkWeChatLoginStatus();if(s.success)if(s.status==="confirmed"){g(),c.value=!1,b.addNotification({type:"success",title:"å¾®ä¿¡ç™»å½•æˆåŠŸ",message:`æ¬¢è¿ï¼Œ${a.displayName}ï¼`});const u=w.query.redirect||"/";P.push(u)}else s.status==="expired"&&(g(),b.addNotification({type:"warning",title:"äºŒç»´ç å·²è¿‡æœŸ",message:"è¯·ç‚¹å‡»åˆ·æ–°é‡æ–°è·å–"}))},2e3)},g=()=>{f&&(clearInterval(f),f=null)},h=()=>{g(),a.cancelWeChatLogin(),c.value=!1};return We(()=>{g()}),(s,u)=>(l(),m("div",Zt,[e("div",eo,[e("div",to,[u[8]||(u[8]=e("div",{class:"login-header"},[e("div",{class:"logo-icon"},"ğŸ“š"),e("h1",{class:"app-title"},"Novel Anime"),e("p",{class:"app-subtitle"},"AIé©±åŠ¨çš„å°è¯´åŠ¨æ¼«ç”Ÿæˆå™¨")],-1)),e("form",{onSubmit:G(E,["prevent"]),class:"auth-form"},[e("div",oo,[u[3]||(u[3]=e("label",{for:"login-username"},"ç”¨æˆ·å / é‚®ç®±",-1)),ie(e("input",{id:"login-username","onUpdate:modelValue":u[0]||(u[0]=r=>p.value.username=r),type:"text",placeholder:"è¯·è¾“å…¥ç”¨æˆ·åæˆ–é‚®ç®±",required:""},null,512),[[Oe,p.value.username]])]),e("div",so,[u[4]||(u[4]=e("label",{for:"login-password"},"å¯†ç ",-1)),e("div",ao,[ie(e("input",{id:"login-password","onUpdate:modelValue":u[1]||(u[1]=r=>p.value.password=r),type:j.value?"text":"password",placeholder:"è¯·è¾“å…¥å¯†ç ",required:""},null,8,lo),[[Me,p.value.password]]),e("button",{type:"button",class:"toggle-password",onClick:u[2]||(u[2]=r=>j.value=!j.value)},y(j.value?"ğŸ™ˆ":"ğŸ‘ï¸"),1)])]),_(S).error||_(a).error?(l(),m("div",no,y(_(S).error||_(a).error),1)):T("",!0),e("button",{type:"submit",class:"submit-btn",disabled:_(S).isLoading||_(a).isLoading},y(_(S).isLoading||_(a).isLoading?"ç™»å½•ä¸­...":"ç™»å½•"),9,ro)],32),e("div",co,[u[7]||(u[7]=e("div",{class:"divider"},[e("span",null,"ç¬¬ä¸‰æ–¹ç™»å½•")],-1)),e("div",io,[e("button",{class:"oauth-btn google",onClick:x,disabled:_(a).oauthProvider==="google"},[...u[5]||(u[5]=[Be('<svg class="oauth-icon" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" data-v-db8b85c2><path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4" data-v-db8b85c2></path><path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853" data-v-db8b85c2></path><path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05" data-v-db8b85c2></path><path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335" data-v-db8b85c2></path></svg> Google ',2)])],8,uo),e("button",{class:"oauth-btn wechat",onClick:N,disabled:_(a).oauthProvider==="wechat"},[...u[6]||(u[6]=[e("svg",{class:"oauth-icon",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M8.691 2.188C3.891 2.188 0 5.476 0 9.53c0 2.212 1.17 4.203 3.002 5.55a.59.59 0 0 1 .213.665l-.39 1.48c-.019.07-.048.141-.048.213 0 .163.13.295.29.295a.326.326 0 0 0 .167-.054l1.903-1.114a.864.864 0 0 1 .717-.098 10.16 10.16 0 0 0 2.837.403c.276 0 .543-.027.811-.05-.857-2.578.157-4.972 1.932-6.446 1.703-1.415 3.882-1.98 5.853-1.838-.576-3.583-4.196-6.348-8.596-6.348zM5.785 5.991c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178A1.17 1.17 0 0 1 4.623 7.17c0-.651.52-1.18 1.162-1.18zm5.813 0c.642 0 1.162.529 1.162 1.18a1.17 1.17 0 0 1-1.162 1.178 1.17 1.17 0 0 1-1.162-1.178c0-.651.52-1.18 1.162-1.18zm5.34 2.867c-1.797-.052-3.746.512-5.28 1.786-1.72 1.428-2.687 3.72-1.78 6.22.942 2.453 3.666 4.229 6.884 4.229.826 0 1.622-.12 2.361-.336a.722.722 0 0 1 .598.082l1.584.926a.272.272 0 0 0 .14.047c.134 0 .24-.111.24-.247 0-.06-.023-.12-.038-.177l-.327-1.233a.582.582 0 0 1-.023-.156.49.49 0 0 1 .201-.398C23.024 18.48 24 16.82 24 14.98c0-3.21-2.931-5.837-6.656-6.088V8.89c-.135-.01-.27-.027-.407-.03zm-2.53 3.274c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983.976.976 0 0 1-.969-.983c0-.542.434-.982.969-.982zm4.844 0c.535 0 .969.44.969.982a.976.976 0 0 1-.969.983.976.976 0 0 1-.969-.983c0-.542.434-.982.969-.982z",fill:"#07C160"})],-1),Q(" å¾®ä¿¡ ",-1)])],8,vo)])])]),e("div",po," v"+y(_(Ve)),1)]),c.value?(l(),m("div",{key:0,class:"dialog-overlay",onClick:G(h,["self"])},[e("div",go,[e("div",{class:"dialog-header"},[u[9]||(u[9]=e("h3",null,"å¾®ä¿¡æ‰«ç ç™»å½•",-1)),e("button",{class:"close-btn",onClick:h},"âœ•")]),e("div",mo,[_(a).wechatQRCode?(l(),m("div",ho,[e("img",{src:_(a).wechatQRCode.qrCodeUrl,alt:"WeChat QR Code"},null,8,fo)])):(l(),m("div",wo,"åŠ è½½ä¸­...")),e("p",jo,y(A.value),1),_(a).wechatLoginStatus==="expired"?(l(),m("button",{key:2,class:"refresh-btn",onClick:N}," åˆ·æ–°äºŒç»´ç  ")):T("",!0)])])])):T("",!0)]))}}),yo=W(_o,[["__scopeId","data-v-db8b85c2"]]),bo=()=>q(()=>import("./Settings-DFQEsv6e.js"),__vite__mapDeps([4,3,5,1,0,2,6,7,8,9,10]),import.meta.url),Io=()=>q(()=>import("./WorkflowEditor-C_1UNyiG.js"),__vite__mapDeps([11,5,1,0,2,3,12,9,13,14,15,16]),import.meta.url),ko=()=>q(()=>import("./AssetsView-BobqhZam.js"),__vite__mapDeps([17,0,1,2,3,5,18]),import.meta.url),Po=()=>q(()=>import("./CharactersView-BPl-9BdA.js"),__vite__mapDeps([19,5,1,0,2,3,13,9,20,21,6,7,22]),import.meta.url),So=()=>q(()=>import("./CharacterDetailView-95jXuLlX.js"),__vite__mapDeps([23,0,1,2,3,6,7,24]),import.meta.url),Co=()=>q(()=>import("./ProfileView-Bbki-Jbz.js"),__vite__mapDeps([25,0,1,2,3,26]),import.meta.url),$o=()=>q(()=>import("./PreviewView-DYjBCMba.js"),__vite__mapDeps([27,5,1,0,2,3,6,7,28]),import.meta.url),Ao=()=>q(()=>import("./GeneratedContentView-ChQnmZHE.js"),__vite__mapDeps([29,3,0,1,2,30]),import.meta.url);console.log("ğŸ›£ï¸ Router configuration loading with lazy loading...");const No=[{path:"/login",name:"login",component:yo,meta:{guest:!0}},{path:"/",redirect:"/dashboard"},{path:"/dashboard",name:"dashboard",component:Yt,meta:{requiresAuth:!0}},{path:"/workflow",name:"workflow",component:Io,meta:{requiresAuth:!0}},{path:"/generated",name:"generated",component:Ao,meta:{requiresAuth:!0}},{path:"/preview",name:"preview",component:$o,meta:{requiresAuth:!1}},{path:"/assets",name:"assets",component:ko,meta:{requiresAuth:!0}},{path:"/characters",name:"characters",component:Po,meta:{requiresAuth:!0}},{path:"/characters/:id",name:"character-detail",component:So,meta:{requiresAuth:!0}},{path:"/settings",name:"settings",component:bo,meta:{requiresAuth:!0}},{path:"/profile",name:"profile",component:Co,meta:{requiresAuth:!0}}],Do=Re({history:qe(),routes:No});Do.beforeEach(async(v,P,w)=>{console.log("ğŸ” Router beforeEach:",{to:v.path,from:P.path,requiresAuth:v.meta.requiresAuth,guest:v.meta.guest});const a=Lo();if(v.meta.requiresAuth&&!a){console.log("ğŸš« Auth required, redirecting to login"),w({path:"/login",query:{redirect:v.fullPath}});return}if(v.meta.guest&&a){console.log("âœ… Already authenticated, redirecting to dashboard"),w("/dashboard");return}console.log("âœ… Navigation allowed"),w()});function Lo(){try{const v=localStorage.getItem("novel_anime_access_token"),P=localStorage.getItem("novel_anime_user_data");return v&&P?(console.log("ğŸ” Found auth token in localStorage"),!0):v?(console.log("ğŸ” Found auth token (user data pending)"),!0):!1}catch(v){return console.error("Error checking auth status:",v),!1}}console.log("âœ… Router configuration loaded");export{Do as default};

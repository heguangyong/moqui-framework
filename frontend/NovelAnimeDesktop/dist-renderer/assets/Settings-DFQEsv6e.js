import{_ as De}from"./preload-helper-CmsKOCeN.js";import{vModelDynamic as ce,vModelText as M,vModelCheckbox as W}from"./vue.runtime.esm-bundler-tGj6Om4U.js";import{_ as Q,u as Ie,c as Ae,d as $e,i as u}from"./_plugin-vue_export-helper-BFgqyxDe.js";import{V as ze}from"./ViewHeader-DsFMPudV.js";import{u as Ne,a as Pe}from"./useTheme-yXL8gOdE.js";import{I as ve,d as V,j as n,k as l,l as e,A as pe,F as h,z as k,x as m,v as a,y as r,s as p,G as de,r as C,a as Te,C as Oe,K as Le,D as q,B as Ve,p as d,u as v,q as S}from"./runtime-core.esm-bundler-8-XbLWPr.js";import{a as H}from"./api-BR07cdPl.js";import"./pinia-Be3yrKEl.js";const Ge={class:"tutorial-menu"},Me={class:"tutorial-menu__settings"},Ue={class:"tutorial-menu__toggle"},Ke=["checked"],Ee={class:"tutorial-menu__list"},Re={class:"tutorial-item__icon"},je={key:0,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Be={key:1,width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},Fe={class:"tutorial-item__content"},Je={class:"tutorial-item__name"},We={class:"tutorial-item__description"},qe={class:"tutorial-item__meta"},He={class:"tutorial-item__steps"},Qe={key:0,class:"tutorial-item__badge tutorial-item__badge--completed"},Xe={key:1,class:"tutorial-item__badge tutorial-item__badge--skipped"},Ye={class:"tutorial-item__actions"},Ze=["onClick"],et=["onClick"],tt=ve({__name:"TutorialMenu",setup(X){const{getAllTutorials:O,isTutorialCompleted:c,isTutorialSkipped:N,shouldShowTutorials:x,setShowTutorials:D,startTutorial:L,resetTutorial:U,resetAllTutorials:P}=Ne(),_=V(()=>O()),y=V(()=>x());function G(T){L(T)}function j(T){confirm("确定要重置此教程的进度吗？")&&U(T)}function K(){confirm("确定要重置所有教程的进度吗？这将清除所有已完成和已跳过的记录。")&&P()}function B(T){const f=T.target;D(f.checked)}return(T,f)=>(l(),n("div",Ge,[f[5]||(f[5]=e("div",{class:"tutorial-menu__header"},[e("h3",{class:"tutorial-menu__title"},"教程中心"),e("p",{class:"tutorial-menu__subtitle"},"学习如何使用小说动漫生成器的各项功能")],-1)),e("div",Me,[e("label",Ue,[e("input",{type:"checkbox",checked:y.value,onChange:B},null,40,Ke),f[0]||(f[0]=e("span",{class:"tutorial-menu__toggle-label"},"启用新手引导",-1))]),e("button",{class:"tutorial-menu__reset",onClick:K,title:"重置所有教程进度"},[...f[1]||(f[1]=[e("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"},[e("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"}),e("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"})],-1),pe(" 重置所有教程 ",-1)])])]),e("div",Ee,[(l(!0),n(h,null,k(_.value,b=>(l(),n("div",{key:b.id,class:m(["tutorial-item",{"tutorial-item--completed":a(c)(b.id),"tutorial-item--skipped":a(N)(b.id)}])},[e("div",Re,[a(c)(b.id)?(l(),n("svg",je,[...f[2]||(f[2]=[e("path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14"},null,-1),e("polyline",{points:"22 4 12 14.01 9 11.01"},null,-1)])])):(l(),n("svg",Be,[...f[3]||(f[3]=[e("circle",{cx:"12",cy:"12",r:"10"},null,-1),e("path",{d:"M12 16v-4"},null,-1),e("path",{d:"M12 8h.01"},null,-1)])]))]),e("div",Fe,[e("h4",Je,r(b.name),1),e("p",We,r(b.description),1),e("div",qe,[e("span",He,r(b.steps.length)+" 个步骤 ",1),a(c)(b.id)?(l(),n("span",Qe," 已完成 ")):a(N)(b.id)?(l(),n("span",Xe," 已跳过 ")):p("",!0)])]),e("div",Ye,[e("button",{class:"tutorial-item__btn tutorial-item__btn--primary",onClick:F=>G(b.id)},r(a(c)(b.id)?"重新学习":"开始"),9,Ze),a(c)(b.id)||a(N)(b.id)?(l(),n("button",{key:0,class:"tutorial-item__btn tutorial-item__btn--secondary",onClick:F=>j(b.id),title:"重置此教程"},[...f[4]||(f[4]=[e("svg",{width:"16",height:"16",viewBox:"0 0 16 16",fill:"currentColor"},[e("path",{d:"M8 3a5 5 0 1 0 4.546 2.914.5.5 0 0 1 .908-.417A6 6 0 1 1 8 2v1z"}),e("path",{d:"M8 4.466V.534a.25.25 0 0 1 .41-.192l2.36 1.966c.12.1.12.284 0 .384L8.41 4.658A.25.25 0 0 1 8 4.466z"})],-1)])],8,et)):p("",!0)])],2))),128))])]))}}),st=Q(tt,[["__scopeId","data-v-9e1aaf85"]]),it={class:"theme-selector"},lt={class:"theme-selector__options"},ot=["onClick"],nt={class:"theme-option__icon"},at={width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},rt={key:1,d:"M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"},ut={class:"theme-option__content"},ct={class:"theme-option__label"},dt={class:"theme-option__description"},vt={key:0,class:"theme-option__check"},pt={class:"theme-selector__preview"},gt={class:"preview-label"},mt={key:0,class:"preview-hint"},_t=ve({__name:"ThemeSelector",setup(X){const{currentTheme:O,actualTheme:c,systemPreference:N,setTheme:x,getThemeLabel:D}=Pe(),L=[{value:"light",label:"浅色",description:"始终使用浅色主题"},{value:"dark",label:"深色",description:"始终使用深色主题"},{value:"auto",label:"跟随系统",description:"根据系统设置自动切换"}];function U(P){x(P)}return(P,_)=>(l(),n("div",it,[e("div",lt,[(l(),n(h,null,k(L,y=>e("button",{key:y.value,class:m(["theme-option",{"theme-option--active":a(O)===y.value}]),onClick:G=>U(y.value)},[e("div",nt,[(l(),n("svg",at,[y.value==="light"?(l(),n(h,{key:0},[_[0]||(_[0]=de('<circle cx="12" cy="12" r="5" data-v-89ab627e></circle><line x1="12" y1="1" x2="12" y2="3" data-v-89ab627e></line><line x1="12" y1="21" x2="12" y2="23" data-v-89ab627e></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64" data-v-89ab627e></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78" data-v-89ab627e></line><line x1="1" y1="12" x2="3" y2="12" data-v-89ab627e></line><line x1="21" y1="12" x2="23" y2="12" data-v-89ab627e></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36" data-v-89ab627e></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22" data-v-89ab627e></line>',9))],64)):y.value==="dark"?(l(),n("path",rt)):(l(),n(h,{key:2},[_[1]||(_[1]=e("rect",{x:"2",y:"3",width:"20",height:"14",rx:"2",ry:"2"},null,-1)),_[2]||(_[2]=e("line",{x1:"8",y1:"21",x2:"16",y2:"21"},null,-1)),_[3]||(_[3]=e("line",{x1:"12",y1:"17",x2:"12",y2:"21"},null,-1))],64))]))]),e("div",ut,[e("div",ct,r(y.label),1),e("div",dt,r(y.description),1)]),a(O)===y.value?(l(),n("div",vt,[..._[4]||(_[4]=[e("svg",{width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2"},[e("polyline",{points:"20 6 9 17 4 12"})],-1)])])):p("",!0)],10,ot)),64))]),e("div",pt,[e("div",{class:m(["preview-card",`preview-card--${a(c)}`])},[..._[5]||(_[5]=[de('<div class="preview-card__header" data-v-89ab627e><div class="preview-dot" data-v-89ab627e></div><div class="preview-dot" data-v-89ab627e></div><div class="preview-dot" data-v-89ab627e></div></div><div class="preview-card__content" data-v-89ab627e><div class="preview-line preview-line--title" data-v-89ab627e></div><div class="preview-line preview-line--text" data-v-89ab627e></div><div class="preview-line preview-line--text" data-v-89ab627e></div><div class="preview-button" data-v-89ab627e></div></div>',2)])],2),e("div",gt,[pe(" 当前预览: "+r(a(D)(a(c)))+" ",1),a(O)==="auto"?(l(),n("span",mt," (系统: "+r(a(D)(a(N)))+") ",1)):p("",!0)])])]))}}),ft=Q(_t,[["__scopeId","data-v-89ab627e"]]),bt={class:"settings-view"},yt={class:"settings-content"},ht={key:0,class:"settings-section profile-section"},kt={class:"profile-card"},wt={class:"avatar-section"},Ct={class:"change-avatar-btn"},St={class:"info-section"},xt={class:"info-group"},Dt={class:"info-value"},It={class:"info-group"},At={class:"info-value"},$t={class:"info-group"},zt={class:"info-value"},Nt={class:"info-group"},Pt={class:"info-value"},Tt={class:"credits-card"},Ot={class:"credits-header"},Lt={class:"credits-amount"},Vt={class:"amount"},Gt={class:"security-card"},Mt={class:"security-info"},Ut={class:"security-info"},Kt={class:"security-text"},Et={class:"security-desc"},Rt={class:"security-info"},jt={key:1,class:"settings-section"},Bt={class:"setting-group"},Ft={key:0,class:"custom-select__options"},Jt=["onClick"],Wt={class:"setting-group"},qt={class:"input-with-action"},Ht=["type"],Qt={class:"setting-group"},Xt={class:"setting-group"},Yt={key:0,class:"custom-select__options"},Zt=["onClick"],es={class:"setting-group"},ts={key:0,class:"custom-select__options"},ss=["onClick"],is={class:"option-content"},ls={class:"option-label"},os={class:"option-desc"},ns={class:"setting-hint"},as={key:0,class:"setting-group"},rs={key:1,class:"setting-group"},us={class:"input-with-action"},cs=["type"],ds={key:2,class:"setting-group"},vs={key:0,class:"custom-select__options"},ps=["onClick"],gs={key:2,class:"settings-section"},ms={class:"setting-group"},_s={key:0,class:"custom-select__options"},fs=["onClick"],bs={class:"setting-group"},ys={key:0,class:"custom-select__options"},hs=["onClick"],ks={class:"setting-group"},ws={key:0,class:"custom-select__options"},Cs=["onClick"],Ss={class:"setting-group"},xs={class:"setting-group"},Ds={class:"toggle-group"},Is={class:"toggle"},As={key:0,class:"setting-group"},$s={key:0,class:"custom-select__options"},zs=["onClick"],Ns={key:3,class:"settings-section"},Ps={class:"setting-group"},Ts={class:"setting-group"},Os={key:0,class:"custom-select__options"},Ls=["onClick"],Vs={class:"setting-group"},Gs={key:0,class:"custom-select__options"},Ms=["onClick"],Us={class:"setting-group"},Ks={class:"toggle-group"},Es={class:"toggle"},Rs={key:4,class:"settings-section"},js={class:"setting-group"},Bs={class:"input-with-action"},Fs={class:"setting-group"},Js={class:"input-with-action"},Ws={class:"setting-group"},qs={class:"toggle-group"},Hs={class:"toggle"},Qs={key:0,class:"setting-group"},Xs={class:"storage-info"},Ys={class:"info-item"},Zs={class:"info-value"},ei={key:5,class:"settings-section tutorial-section"},ti={key:6,class:"settings-section"},si={class:"about-info"},ii={class:"app-logo"},li={class:"about-links"},oi={href:"#",class:"about-link"},ni={href:"#",class:"about-link"},ai={href:"#",class:"about-link"},ri={key:7,class:"settings-actions"},ui={__name:"Settings",setup(X){const O=Ie(),c=Ae(),N=$e(),x=C(!1),D=C("用户"),L=C(""),U=V(()=>D.value.charAt(0).toUpperCase()),P=C(0),_=C(""),y=C(new Date),G=C(new Date),j=V(()=>{const o=["#7a9188","#8a9cad","#949c98"],t=D.value.charCodeAt(0)%o.length;return o[t]});function K(o){return o?new Date(o).toLocaleDateString("zh-CN",{year:"numeric",month:"long",day:"numeric"}):"-"}function B(o){c.addNotification({type:"info",title:"功能开发中",message:"编辑功能即将上线",timeout:2e3})}function T(){c.addNotification({type:"info",title:"功能开发中",message:"充值功能即将上线",timeout:2e3})}function f(){c.addNotification({type:"info",title:"功能开发中",message:"修改密码功能即将上线",timeout:2e3})}function b(){c.addNotification({type:"info",title:"功能开发中",message:"绑定手机功能即将上线",timeout:2e3})}async function F(){confirm("确定要退出登录吗？")&&(localStorage.removeItem("auth_token"),localStorage.removeItem("auth_user"),localStorage.removeItem("novel_anime_access_token"),localStorage.removeItem("novel_anime_refresh_token"),c.addNotification({type:"success",title:"已退出",message:"您已成功退出登录",timeout:2e3}),O.push("/login"))}async function ge(){try{const o=await H.axiosInstance.get("/auth/profile");if(o.data){const t=o.data;D.value=t.username||t.userFullName||t.email?.split("@")[0]||"用户",L.value=t.email||t.emailAddress||"",P.value=t.credits||0,_.value=t.phoneNumber||"",y.value=t.createdDate?new Date(t.createdDate):new Date,G.value=t.lastLoginDate?new Date(t.lastLoginDate):new Date,localStorage.setItem("auth_user",JSON.stringify(t));return}}catch(o){console.warn("从后端获取用户信息失败，使用本地缓存:",o)}try{const o=localStorage.getItem("auth_user");if(o){const t=JSON.parse(o);D.value=t.username||t.email?.split("@")[0]||"用户",L.value=t.email||"",P.value=t.credits||0,_.value=t.phoneNumber||"",y.value=t.createdDate?new Date(t.createdDate):new Date,G.value=t.lastLoginDate?new Date(t.lastLoginDate):new Date}}catch(o){console.error("加载用户信息失败:",o)}}const Y=[{value:"pollinations",label:"Pollinations AI (免费)"},{value:"openai",label:"OpenAI (GPT-4)"},{value:"anthropic",label:"Anthropic (Claude)"},{value:"local",label:"本地模型"}],Z=[{value:"flux-anime",label:"Flux Anime (Pollinations)"},{value:"glm-4",label:"GLM-4"},{value:"glm-4v",label:"GLM-4V (视觉)"},{value:"gpt-4",label:"GPT-4"},{value:"gpt-4-turbo",label:"GPT-4 Turbo"},{value:"claude-3",label:"Claude 3"}],ee=[{value:"anime",label:"日式动漫"},{value:"cartoon",label:"卡通风格"},{value:"realistic",label:"写实风格"},{value:"watercolor",label:"水彩风格"},{value:"pixel",label:"像素风格"}],te=[{value:"720p",label:"720p (1280×720)"},{value:"1080p",label:"1080p (1920×1080)"},{value:"2k",label:"2K (2560×1440)"},{value:"4k",label:"4K (3840×2160)"}],se=[{value:24,label:"24 FPS (电影)"},{value:30,label:"30 FPS (标准)"},{value:60,label:"60 FPS (流畅)"}],ie=[{value:"natural",label:"自然"},{value:"dramatic",label:"戏剧化"},{value:"calm",label:"平静"},{value:"energetic",label:"活力"}],le=[{value:"zh-CN",label:"简体中文"},{value:"zh-TW",label:"繁体中文"},{value:"en",label:"English"},{value:"ja",label:"日本語"}],oe=[{value:"small",label:"小"},{value:"medium",label:"中"},{value:"large",label:"大"}],ne=[{value:"pollinations",label:"Pollinations AI",description:"免费 AI 图片生成服务（推荐）"},{value:"placeholder",label:"占位符图片",description:"使用占位符服务（免费，立即可用）"},{value:"stable-diffusion",label:"Stable Diffusion",description:"开源AI图片生成（需本地部署）"},{value:"dalle",label:"DALL-E 3",description:"OpenAI图片生成（高质量，收费）"}],ae=[{value:"dall-e-3",label:"DALL-E 3"},{value:"dall-e-2",label:"DALL-E 2"}],E=C(!1);function me(o){return{pollinations:"Pollinations AI 提供免费的 AI 图片生成服务，无需 API 密钥，推荐使用",placeholder:"使用占位符图片服务，免费且立即可用，但不是真实的AI生成图片","stable-diffusion":"需要本地部署Stable Diffusion WebUI，开源免费，质量高",dalle:"使用OpenAI的DALL-E服务，质量最高，但需要API密钥和费用"}[o]||""}const J={profile:{label:"个人资料",description:"管理您的账户信息"},ai:{label:"AI服务配置",description:"配置AI服务提供商和API密钥"},generation:{label:"生成参数",description:"配置视频生成的默认参数"},interface:{label:"界面设置",description:"自定义应用界面外观"},storage:{label:"存储设置",description:"管理项目存储和缓存"},tutorial:{label:"教程中心",description:"学习如何使用应用的各项功能"},about:{label:"关于",description:"应用信息和更新"}},I=V(()=>N.panelContext.settings?.activeCategory||"profile"),_e=V(()=>J[I.value]?.label||"设置"),fe=V(()=>J[I.value]?.description||""),R=C(!1),re=C("128 MB"),g=C(null),i=Te({ai:{provider:"pollinations",apiKey:"",endpoint:"",model:"flux-anime"},generation:{style:"anime",resolution:"1080p",fps:30,episodeDuration:5,enableVoice:!0,voiceStyle:"natural"},interface:{theme:"light",language:"zh-CN",fontSize:"medium",animations:!0},storage:{projectDir:"~/Documents/NovelAnime/Projects",cacheDir:"~/Documents/NovelAnime/Cache",autoSave:!0,autoSaveInterval:5},imageGeneration:{provider:"pollinations",apiKey:"",apiUrl:"",model:"",size:"800x450",quality:"standard"}});function A(o){g.value=g.value===o?null:o}function $(o,t,s){i[o][t]=s,g.value=null}function z(o,t){const s=o.find(w=>w.value===t);return s?s.label:t}function ue(o){o.target.closest(".custom-select")||(g.value=null)}Oe(()=>{be(),ge(),document.addEventListener("click",ue);const o=N.panelContext.settings?.activeCategory;(!o||!J[o])&&N.updatePanelContext("settings",{activeCategory:"profile"})}),Le(()=>{document.removeEventListener("click",ue)});async function be(){try{const o=await H.getUserSettings();o.success&&o.settings&&(o.settings.theme&&(i.interface.theme=o.settings.theme),o.settings.language&&(i.interface.language=o.settings.language),o.settings.autoSave!==void 0&&(i.storage.autoSave=o.settings.autoSave))}catch(o){console.warn("从后端加载用户设置失败:",o)}try{const o=localStorage.getItem("novel-anime-settings");if(o){const t=JSON.parse(o);if(t.ai&&Object.assign(i.ai,t.ai),t.generation&&Object.assign(i.generation,t.generation),!i.interface.theme&&t.interface?.theme&&(i.interface.theme=t.interface.theme),t.storage){const s=i.storage.autoSave;Object.assign(i.storage,t.storage),s!==void 0&&(i.storage.autoSave=s)}}}catch(o){console.error("加载本地设置失败:",o)}}async function ye(){if(!x.value){if(i.ai.provider==="pollinations"){c.addNotification({type:"success",title:"配置正确",message:"Pollinations AI 无需 API 密钥，可以直接使用",timeout:3e3});return}if(!i.ai.apiKey){c.addNotification({type:"error",title:"连接失败",message:"请先输入API密钥",timeout:3e3});return}x.value=!0,c.addNotification({type:"info",title:"测试连接",message:"正在测试AI服务连接...",timeout:2e3});try{localStorage.setItem("novel-anime-settings",JSON.stringify(i));const t=await(await fetch("http://localhost:8080/rest/s1/mcp/user/ai-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:i.ai.provider.toUpperCase(),model:i.ai.model,apiBase:i.ai.endpoint||void 0,apiKey:i.ai.apiKey})})).json();if(t.success)c.addNotification({type:"success",title:"连接成功",message:t.message||"AI配置已保存到MCP后端",timeout:3e3});else throw new Error(t.error||"连接测试失败")}catch(o){console.error("AI connection test failed:",o),o.code==="ERR_NETWORK"||o.message?.includes("Network Error")?i.ai.apiKey.length>=10?c.addNotification({type:"success",title:"配置已保存",message:"API密钥格式正确，设置已保存（后端离线，无法验证连接）",timeout:4e3}):c.addNotification({type:"warning",title:"格式警告",message:"API密钥格式可能不正确，请检查",timeout:3e3}):c.addNotification({type:"error",title:"连接失败",message:o.response?.data?.message||o.message||"无法连接到AI服务",timeout:4e3})}finally{x.value=!1}}}async function he(){if(!x.value){x.value=!0,c.addNotification({type:"info",title:"测试图片生成",message:"正在测试图片生成服务...",timeout:2e3});try{localStorage.setItem("image_generation_config",JSON.stringify(i.imageGeneration));const{imageGenerationService:o}=await De(async()=>{const{imageGenerationService:s}=await import("./ImageGenerationService-5Ehzbncq.js");return{imageGenerationService:s}},[],import.meta.url);o.saveConfig(i.imageGeneration);const t=await o.testConnection();if(t.success){c.addNotification({type:"success",title:"连接成功",message:t.message,timeout:3e3}),c.addNotification({type:"info",title:"生成测试图片",message:"正在生成测试图片...",timeout:2e3});const s=await o.generateImage({prompt:"anime style, beautiful landscape, sunset, mountains",width:400,height:300});c.addNotification({type:"success",title:"测试成功",message:"图片生成服务工作正常！",timeout:3e3}),console.log("测试图片生成成功:",s)}else throw new Error(t.message)}catch(o){console.error("Image generation test failed:",o),c.addNotification({type:"error",title:"测试失败",message:o.message||"图片生成服务测试失败",timeout:4e3})}finally{x.value=!1}}}function ke(){c.addNotification({type:"info",title:"选择目录",message:"请选择项目存储目录",timeout:2e3})}function we(){c.addNotification({type:"info",title:"选择目录",message:"请选择缓存目录",timeout:2e3})}function Ce(){confirm("确定要清除所有缓存吗？")&&(c.addNotification({type:"success",title:"清除成功",message:"缓存已清除",timeout:2e3}),re.value="0 B")}function Se(){confirm("确定要重置所有设置为默认值吗？")&&(i.ai={provider:"pollinations",apiKey:"",endpoint:"",model:"flux-anime"},i.generation={style:"anime",resolution:"1080p",fps:30,episodeDuration:5,enableVoice:!0,voiceStyle:"natural"},i.interface={theme:"light",language:"zh-CN",fontSize:"medium",animations:!0},i.storage={projectDir:"~/Documents/NovelAnime/Projects",cacheDir:"~/Documents/NovelAnime/Cache",autoSave:!0,autoSaveInterval:5},c.addNotification({type:"success",title:"重置成功",message:"设置已重置为默认值",timeout:2e3}))}async function xe(){try{localStorage.setItem("novel-anime-settings",JSON.stringify(i));try{await H.updateUserSettings({theme:i.interface.theme,language:i.interface.language,autoSave:i.storage.autoSave})}catch(t){console.warn("Failed to sync user settings to backend:",t)}const o=["openai","anthropic","local"];if(i.ai.apiKey&&o.includes(i.ai.provider))try{const s=await(await fetch("http://localhost:8080/rest/s1/mcp/user/ai-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({provider:i.ai.provider.toUpperCase(),model:i.ai.model,apiBase:i.ai.endpoint||void 0,apiKey:i.ai.apiKey})})).json();s.success?console.log("✅ AI配置已同步到MCP后端:",s.message):console.warn("⚠️ MCP后端同步失败:",s.error)}catch(t){console.warn("Failed to sync AI settings to MCP backend:",t)}c.addNotification({type:"success",title:"保存成功",message:"设置已保存",timeout:2e3})}catch(o){c.addNotification({type:"error",title:"保存失败",message:o.message,timeout:3e3})}}return(o,t)=>(l(),n("div",bt,[q(ze,{title:_e.value,subtitle:fe.value},null,8,["title","subtitle"]),e("div",yt,[I.value==="profile"?(l(),n("div",ht,[e("div",kt,[e("div",wt,[e("div",{class:"avatar-large",style:Ve({background:j.value})},r(U.value),5),e("button",Ct,[(l(),d(v(a(u).camera),{size:16})),t[24]||(t[24]=e("span",null,"更换头像",-1))])]),e("div",St,[e("div",xt,[t[25]||(t[25]=e("label",null,"用户名",-1)),e("div",Dt,[e("span",null,r(D.value),1),e("button",{class:"edit-btn",onClick:t[0]||(t[0]=s=>B())},[(l(),d(v(a(u).edit),{size:14}))])])]),e("div",It,[t[27]||(t[27]=e("label",null,"邮箱",-1)),e("div",At,[e("span",null,r(L.value),1),t[26]||(t[26]=e("span",{class:"verified-badge"},"已验证",-1))])]),e("div",$t,[t[28]||(t[28]=e("label",null,"注册时间",-1)),e("div",zt,[e("span",null,r(K(y.value)),1)])]),e("div",Nt,[t[29]||(t[29]=e("label",null,"最后登录",-1)),e("div",Pt,[e("span",null,r(K(G.value)),1)])])])]),e("div",Tt,[e("div",Ot,[t[31]||(t[31]=e("h3",null,"积分余额",-1)),e("button",{class:"recharge-btn",onClick:T},[(l(),d(v(a(u).plus),{size:16})),t[30]||(t[30]=e("span",null,"充值",-1))])]),e("div",Lt,[e("span",Vt,r(P.value),1),t[32]||(t[32]=e("span",{class:"unit"},"积分",-1))]),t[33]||(t[33]=e("div",{class:"credits-hint"}," 积分可用于AI生成、角色分析等功能 ",-1))]),e("div",Gt,[t[37]||(t[37]=e("h3",null,"安全设置",-1)),e("div",{class:"security-item",onClick:f},[e("div",Mt,[(l(),d(v(a(u).lock),{size:20})),t[34]||(t[34]=e("div",{class:"security-text"},[e("span",{class:"security-title"},"修改密码"),e("span",{class:"security-desc"},"定期更换密码以保护账户安全")],-1))]),(l(),d(v(a(u).chevronRight),{size:20,class:"arrow"}))]),e("div",{class:"security-item",onClick:b},[e("div",Ut,[(l(),d(v(a(u).phone),{size:20})),e("div",Kt,[t[35]||(t[35]=e("span",{class:"security-title"},"绑定手机",-1)),e("span",Et,r(_.value||"未绑定"),1)])]),(l(),d(v(a(u).chevronRight),{size:20,class:"arrow"}))]),e("div",{class:"security-item security-item--danger",onClick:F},[e("div",Rt,[(l(),d(v(a(u).logOut),{size:20})),t[36]||(t[36]=e("div",{class:"security-text"},[e("span",{class:"security-title"},"退出登录"),e("span",{class:"security-desc"},"退出当前账户")],-1))]),(l(),d(v(a(u).chevronRight),{size:20,class:"arrow"}))])])])):p("",!0),I.value==="ai"?(l(),n("div",jt,[e("div",Bt,[t[38]||(t[38]=e("label",{class:"setting-label"},"AI服务提供商",-1)),e("div",{class:m(["custom-select",{"custom-select--open":g.value==="provider"}])},[e("div",{class:"custom-select__trigger",onClick:t[1]||(t[1]=s=>A("provider"))},[e("span",null,r(z(Y,i.ai.provider)),1),(l(),d(v(a(u).chevronDown),{size:16,class:"select-arrow"}))]),g.value==="provider"?(l(),n("div",Ft,[(l(),n(h,null,k(Y,s=>e("div",{key:s.value,class:m(["custom-select__option",{"custom-select__option--selected":i.ai.provider===s.value}]),onClick:w=>$("ai","provider",s.value)},r(s.label),11,Jt)),64))])):p("",!0)],2)]),e("div",Wt,[t[39]||(t[39]=e("label",{class:"setting-label"},"API密钥",-1)),e("div",qt,[S(e("input",{type:R.value?"text":"password","onUpdate:modelValue":t[2]||(t[2]=s=>i.ai.apiKey=s),class:"setting-input",placeholder:"输入API密钥"},null,8,Ht),[[ce,i.ai.apiKey]]),e("button",{class:"input-action",onClick:t[3]||(t[3]=s=>R.value=!R.value)},[(l(),d(v(R.value?a(u).eyeOff:a(u).eye),{size:16}))])]),t[40]||(t[40]=e("p",{class:"setting-hint"},"API密钥将安全存储在本地",-1))]),e("div",Qt,[t[41]||(t[41]=e("label",{class:"setting-label"},"API端点 (可选)",-1)),S(e("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=s=>i.ai.endpoint=s),class:"setting-input",placeholder:"https://api.example.com/v1"},null,512),[[M,i.ai.endpoint]]),t[42]||(t[42]=e("p",{class:"setting-hint"},"留空使用默认端点",-1))]),e("div",Xt,[t[43]||(t[43]=e("label",{class:"setting-label"},"模型选择",-1)),e("div",{class:m(["custom-select",{"custom-select--open":g.value==="model"}])},[e("div",{class:"custom-select__trigger",onClick:t[5]||(t[5]=s=>A("model"))},[e("span",null,r(z(Z,i.ai.model)),1),(l(),d(v(a(u).chevronDown),{size:16,class:"select-arrow"}))]),g.value==="model"?(l(),n("div",Yt,[(l(),n(h,null,k(Z,s=>e("div",{key:s.value,class:m(["custom-select__option",{"custom-select__option--selected":i.ai.model===s.value}]),onClick:w=>$("ai","model",s.value)},r(s.label),11,Zt)),64))])):p("",!0)],2)]),e("button",{class:"test-btn",onClick:ye},[(l(),d(v(a(u).zap),{size:16})),t[44]||(t[44]=e("span",null,"测试连接",-1))]),t[52]||(t[52]=e("div",{class:"setting-divider"},null,-1)),t[53]||(t[53]=e("h3",{class:"setting-subtitle"},"图片生成配置",-1)),e("div",es,[t[45]||(t[45]=e("label",{class:"setting-label"},"图片生成服务",-1)),e("div",{class:m(["custom-select",{"custom-select--open":g.value==="imageProvider"}])},[e("div",{class:"custom-select__trigger",onClick:t[6]||(t[6]=s=>A("imageProvider"))},[e("span",null,r(z(ne,i.imageGeneration.provider)),1),(l(),d(v(a(u).chevronDown),{size:16,class:"select-arrow"}))]),g.value==="imageProvider"?(l(),n("div",ts,[(l(),n(h,null,k(ne,s=>e("div",{key:s.value,class:m(["custom-select__option",{"custom-select__option--selected":i.imageGeneration.provider===s.value}]),onClick:w=>$("imageGeneration","provider",s.value)},[e("div",is,[e("span",ls,r(s.label),1),e("span",os,r(s.description),1)])],10,ss)),64))])):p("",!0)],2),e("p",ns,r(me(i.imageGeneration.provider)),1)]),i.imageGeneration.provider==="stable-diffusion"?(l(),n("div",as,[t[46]||(t[46]=e("label",{class:"setting-label"},"Stable Diffusion API地址",-1)),S(e("input",{type:"text","onUpdate:modelValue":t[7]||(t[7]=s=>i.imageGeneration.apiUrl=s),class:"setting-input",placeholder:"http://localhost:7860"},null,512),[[M,i.imageGeneration.apiUrl]]),t[47]||(t[47]=e("p",{class:"setting-hint"},"本地部署的Stable Diffusion WebUI地址",-1))])):p("",!0),i.imageGeneration.provider==="dalle"?(l(),n("div",rs,[t[48]||(t[48]=e("label",{class:"setting-label"},"OpenAI API密钥",-1)),e("div",us,[S(e("input",{type:E.value?"text":"password","onUpdate:modelValue":t[8]||(t[8]=s=>i.imageGeneration.apiKey=s),class:"setting-input",placeholder:"sk-..."},null,8,cs),[[ce,i.imageGeneration.apiKey]]),e("button",{class:"input-action",onClick:t[9]||(t[9]=s=>E.value=!E.value)},[(l(),d(v(E.value?a(u).eyeOff:a(u).eye),{size:16}))])]),t[49]||(t[49]=e("p",{class:"setting-hint"},"用于DALL-E图片生成的API密钥",-1))])):p("",!0),i.imageGeneration.provider==="dalle"?(l(),n("div",ds,[t[50]||(t[50]=e("label",{class:"setting-label"},"DALL-E模型",-1)),e("div",{class:m(["custom-select",{"custom-select--open":g.value==="dalleModel"}])},[e("div",{class:"custom-select__trigger",onClick:t[10]||(t[10]=s=>A("dalleModel"))},[e("span",null,r(z(ae,i.imageGeneration.model)),1),(l(),d(v(a(u).chevronDown),{size:16,class:"select-arrow"}))]),g.value==="dalleModel"?(l(),n("div",vs,[(l(),n(h,null,k(ae,s=>e("div",{key:s.value,class:m(["custom-select__option",{"custom-select__option--selected":i.imageGeneration.model===s.value}]),onClick:w=>$("imageGeneration","model",s.value)},r(s.label),11,ps)),64))])):p("",!0)],2)])):p("",!0),e("button",{class:"test-btn",onClick:he},[(l(),d(v(a(u).image),{size:16})),t[51]||(t[51]=e("span",null,"测试图片生成",-1))])])):p("",!0),I.value==="generation"?(l(),n("div",gs,[e("div",ms,[t[54]||(t[54]=e("label",{class:"setting-label"},"视频风格",-1)),e("div",{class:m(["custom-select",{"custom-select--open":g.value==="style"}])},[e("div",{class:"custom-select__trigger",onClick:t[11]||(t[11]=s=>A("style"))},[e("span",null,r(z(ee,i.generation.style)),1),(l(),d(v(a(u).chevronDown),{size:16,class:"select-arrow"}))]),g.value==="style"?(l(),n("div",_s,[(l(),n(h,null,k(ee,s=>e("div",{key:s.value,class:m(["custom-select__option",{"custom-select__option--selected":i.generation.style===s.value}]),onClick:w=>$("generation","style",s.value)},r(s.label),11,fs)),64))])):p("",!0)],2)]),e("div",bs,[t[55]||(t[55]=e("label",{class:"setting-label"},"视频分辨率",-1)),e("div",{class:m(["custom-select",{"custom-select--open":g.value==="resolution"}])},[e("div",{class:"custom-select__trigger",onClick:t[12]||(t[12]=s=>A("resolution"))},[e("span",null,r(z(te,i.generation.resolution)),1),(l(),d(v(a(u).chevronDown),{size:16,class:"select-arrow"}))]),g.value==="resolution"?(l(),n("div",ys,[(l(),n(h,null,k(te,s=>e("div",{key:s.value,class:m(["custom-select__option",{"custom-select__option--selected":i.generation.resolution===s.value}]),onClick:w=>$("generation","resolution",s.value)},r(s.label),11,hs)),64))])):p("",!0)],2)]),e("div",ks,[t[56]||(t[56]=e("label",{class:"setting-label"},"帧率",-1)),e("div",{class:m(["custom-select",{"custom-select--open":g.value==="fps"}])},[e("div",{class:"custom-select__trigger",onClick:t[13]||(t[13]=s=>A("fps"))},[e("span",null,r(z(se,i.generation.fps)),1),(l(),d(v(a(u).chevronDown),{size:16,class:"select-arrow"}))]),g.value==="fps"?(l(),n("div",ws,[(l(),n(h,null,k(se,s=>e("div",{key:s.value,class:m(["custom-select__option",{"custom-select__option--selected":i.generation.fps===s.value}]),onClick:w=>$("generation","fps",s.value)},r(s.label),11,Cs)),64))])):p("",!0)],2)]),e("div",Ss,[t[57]||(t[57]=e("label",{class:"setting-label"},"每集时长 (分钟)",-1)),S(e("input",{type:"number","onUpdate:modelValue":t[14]||(t[14]=s=>i.generation.episodeDuration=s),class:"setting-input",min:"1",max:"60"},null,512),[[M,i.generation.episodeDuration,void 0,{number:!0}]])]),e("div",xs,[t[60]||(t[60]=e("label",{class:"setting-label"},"语音合成",-1)),e("div",Ds,[e("label",Is,[S(e("input",{type:"checkbox","onUpdate:modelValue":t[15]||(t[15]=s=>i.generation.enableVoice=s)},null,512),[[W,i.generation.enableVoice]]),t[58]||(t[58]=e("span",{class:"toggle-slider"},null,-1))]),t[59]||(t[59]=e("span",null,"启用AI语音合成",-1))])]),i.generation.enableVoice?(l(),n("div",As,[t[61]||(t[61]=e("label",{class:"setting-label"},"语音风格",-1)),e("div",{class:m(["custom-select",{"custom-select--open":g.value==="voiceStyle"}])},[e("div",{class:"custom-select__trigger",onClick:t[16]||(t[16]=s=>A("voiceStyle"))},[e("span",null,r(z(ie,i.generation.voiceStyle)),1),(l(),d(v(a(u).chevronDown),{size:16,class:"select-arrow"}))]),g.value==="voiceStyle"?(l(),n("div",$s,[(l(),n(h,null,k(ie,s=>e("div",{key:s.value,class:m(["custom-select__option",{"custom-select__option--selected":i.generation.voiceStyle===s.value}]),onClick:w=>$("generation","voiceStyle",s.value)},r(s.label),11,zs)),64))])):p("",!0)],2)])):p("",!0)])):p("",!0),I.value==="interface"?(l(),n("div",Ns,[e("div",Ps,[t[62]||(t[62]=e("label",{class:"setting-label"},"主题",-1)),q(ft)]),e("div",Ts,[t[63]||(t[63]=e("label",{class:"setting-label"},"语言",-1)),e("div",{class:m(["custom-select",{"custom-select--open":g.value==="language"}])},[e("div",{class:"custom-select__trigger",onClick:t[17]||(t[17]=s=>A("language"))},[e("span",null,r(z(le,i.interface.language)),1),(l(),d(v(a(u).chevronDown),{size:16,class:"select-arrow"}))]),g.value==="language"?(l(),n("div",Os,[(l(),n(h,null,k(le,s=>e("div",{key:s.value,class:m(["custom-select__option",{"custom-select__option--selected":i.interface.language===s.value}]),onClick:w=>$("interface","language",s.value)},r(s.label),11,Ls)),64))])):p("",!0)],2)]),e("div",Vs,[t[64]||(t[64]=e("label",{class:"setting-label"},"字体大小",-1)),e("div",{class:m(["custom-select",{"custom-select--open":g.value==="fontSize"}])},[e("div",{class:"custom-select__trigger",onClick:t[18]||(t[18]=s=>A("fontSize"))},[e("span",null,r(z(oe,i.interface.fontSize)),1),(l(),d(v(a(u).chevronDown),{size:16,class:"select-arrow"}))]),g.value==="fontSize"?(l(),n("div",Gs,[(l(),n(h,null,k(oe,s=>e("div",{key:s.value,class:m(["custom-select__option",{"custom-select__option--selected":i.interface.fontSize===s.value}]),onClick:w=>$("interface","fontSize",s.value)},r(s.label),11,Ms)),64))])):p("",!0)],2)]),e("div",Us,[t[67]||(t[67]=e("label",{class:"setting-label"},"动画效果",-1)),e("div",Ks,[e("label",Es,[S(e("input",{type:"checkbox","onUpdate:modelValue":t[19]||(t[19]=s=>i.interface.animations=s)},null,512),[[W,i.interface.animations]]),t[65]||(t[65]=e("span",{class:"toggle-slider"},null,-1))]),t[66]||(t[66]=e("span",null,"启用界面动画",-1))])])])):p("",!0),I.value==="storage"?(l(),n("div",Rs,[e("div",js,[t[68]||(t[68]=e("label",{class:"setting-label"},"默认项目目录",-1)),e("div",Bs,[S(e("input",{type:"text","onUpdate:modelValue":t[20]||(t[20]=s=>i.storage.projectDir=s),class:"setting-input",readonly:""},null,512),[[M,i.storage.projectDir]]),e("button",{class:"input-action",onClick:ke},[(l(),d(v(a(u).folder),{size:16}))])])]),e("div",Fs,[t[69]||(t[69]=e("label",{class:"setting-label"},"缓存目录",-1)),e("div",Js,[S(e("input",{type:"text","onUpdate:modelValue":t[21]||(t[21]=s=>i.storage.cacheDir=s),class:"setting-input",readonly:""},null,512),[[M,i.storage.cacheDir]]),e("button",{class:"input-action",onClick:we},[(l(),d(v(a(u).folder),{size:16}))])])]),e("div",Ws,[t[72]||(t[72]=e("label",{class:"setting-label"},"自动保存",-1)),e("div",qs,[e("label",Hs,[S(e("input",{type:"checkbox","onUpdate:modelValue":t[22]||(t[22]=s=>i.storage.autoSave=s)},null,512),[[W,i.storage.autoSave]]),t[70]||(t[70]=e("span",{class:"toggle-slider"},null,-1))]),t[71]||(t[71]=e("span",null,"启用自动保存",-1))])]),i.storage.autoSave?(l(),n("div",Qs,[t[73]||(t[73]=e("label",{class:"setting-label"},"自动保存间隔 (分钟)",-1)),S(e("input",{type:"number","onUpdate:modelValue":t[23]||(t[23]=s=>i.storage.autoSaveInterval=s),class:"setting-input",min:"1",max:"30"},null,512),[[M,i.storage.autoSaveInterval,void 0,{number:!0}]])])):p("",!0),e("div",Xs,[e("div",Ys,[t[74]||(t[74]=e("span",{class:"info-label"},"缓存大小",-1)),e("span",Zs,r(re.value),1)]),e("button",{class:"clear-cache-btn",onClick:Ce},[(l(),d(v(a(u).trash),{size:14})),t[75]||(t[75]=e("span",null,"清除缓存",-1))])])])):p("",!0),I.value==="tutorial"?(l(),n("div",ei,[q(st)])):p("",!0),I.value==="about"?(l(),n("div",ti,[e("div",si,[e("div",ii,[(l(),d(v(a(u).sparkles),{size:48}))]),t[76]||(t[76]=e("h3",null,"小说动漫生成器",-1)),t[77]||(t[77]=e("p",{class:"version"},"版本 1.0.3",-1)),t[78]||(t[78]=e("p",{class:"description"},"使用AI技术将小说转换为精美的动画视频",-1))]),e("div",li,[e("a",oi,[(l(),d(v(a(u).help),{size:16})),t[79]||(t[79]=e("span",null,"帮助文档",-1))]),e("a",ni,[(l(),d(v(a(u).external),{size:16})),t[80]||(t[80]=e("span",null,"官方网站",-1))]),e("a",ai,[(l(),d(v(a(u).info),{size:16})),t[81]||(t[81]=e("span",null,"检查更新",-1))])])])):p("",!0),I.value!=="about"?(l(),n("div",ri,[e("button",{class:"btn btn--secondary",onClick:Se}," 重置为默认 "),e("button",{class:"btn btn--primary",onClick:xe},[(l(),d(v(a(u).save),{size:16})),t[82]||(t[82]=e("span",null,"保存设置",-1))])])):p("",!0)])]))}},bi=Q(ui,[["__scopeId","data-v-383a900b"]]);export{bi as default};

<template>
  <q-page class="design-system-page">
    <div class="mobile-container">
      <div class="design-system-header">
        <h1>ğŸ¨ Moqui AI Mobile è®¾è®¡ç³»ç»Ÿ</h1>
        <p class="design-system-subtitle">
          åŸºäº Vue 3 + Quasar 2 çš„ç§»åŠ¨ç«¯è®¾è®¡ç³»ç»Ÿç»„ä»¶åº“å±•ç¤º
        </p>
      </div>

      <!-- é¢œè‰²ç³»ç»Ÿ -->
      <section class="design-section">
        <h2>ğŸŒˆ é¢œè‰²ç³»ç»Ÿ</h2>
        <div class="color-palette">
          <div class="color-group">
            <h3>ä¸»è¦é¢œè‰²</h3>
            <div class="color-swatches">
              <div class="color-swatch primary">
                <div class="color-preview"></div>
                <span class="color-name">Primary</span>
                <span class="color-code">#667eea</span>
              </div>
              <div class="color-swatch secondary">
                <div class="color-preview"></div>
                <span class="color-name">Secondary</span>
                <span class="color-code">#764ba2</span>
              </div>
            </div>
          </div>

          <div class="color-group">
            <h3>åŠŸèƒ½é¢œè‰²</h3>
            <div class="color-swatches">
              <div class="color-swatch success">
                <div class="color-preview"></div>
                <span class="color-name">Success</span>
                <span class="color-code">#27ae60</span>
              </div>
              <div class="color-swatch warning">
                <div class="color-preview"></div>
                <span class="color-name">Warning</span>
                <span class="color-code">#f39c12</span>
              </div>
              <div class="color-swatch danger">
                <div class="color-preview"></div>
                <span class="color-name">Danger</span>
                <span class="color-code">#e74c3c</span>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- æŒ‰é’®ç»„ä»¶ -->
      <section class="design-section">
        <h2>ğŸ”˜ æŒ‰é’®ç»„ä»¶</h2>

        <div class="component-showcase">
          <h3>æŒ‰é’®ç±»å‹</h3>
          <div class="button-grid">
            <MobileButton label="ä¸»è¦æŒ‰é’®" type="primary" />
            <MobileButton label="æ¬¡è¦æŒ‰é’®" type="secondary" />
            <MobileButton label="æˆåŠŸæŒ‰é’®" type="success" />
            <MobileButton label="è­¦å‘ŠæŒ‰é’®" type="warning" />
            <MobileButton label="å±é™©æŒ‰é’®" type="danger" />
          </div>
        </div>

        <div class="component-showcase">
          <h3>æŒ‰é’®å˜ä½“</h3>
          <div class="button-grid">
            <MobileButton label="å®å¿ƒæŒ‰é’®" variant="filled" />
            <MobileButton label="æè¾¹æŒ‰é’®" variant="outlined" />
            <MobileButton label="æ–‡å­—æŒ‰é’®" variant="text" />
          </div>
        </div>

        <div class="component-showcase">
          <h3>æŒ‰é’®å°ºå¯¸</h3>
          <div class="button-grid">
            <MobileButton label="å°æŒ‰é’®" size="sm" />
            <MobileButton label="ä¸­æŒ‰é’®" size="md" />
            <MobileButton label="å¤§æŒ‰é’®" size="lg" />
          </div>
        </div>

        <div class="component-showcase">
          <h3>ç‰¹æ®ŠçŠ¶æ€</h3>
          <div class="button-grid">
            <MobileButton label="åŠ è½½ä¸­" :loading="true" />
            <MobileButton label="ç¦ç”¨çŠ¶æ€" disabled />
            <MobileButton icon="heart" icon-only />
            <MobileButton label="åœ†è§’æŒ‰é’®" rounded />
            <MobileButton label="å—çº§æŒ‰é’®" block />
          </div>
        </div>
      </section>

      <!-- è¾“å…¥æ¡†ç»„ä»¶ -->
      <section class="design-section">
        <h2>ğŸ“ è¾“å…¥æ¡†ç»„ä»¶</h2>

        <div class="component-showcase">
          <h3>è¾“å…¥æ¡†å˜ä½“</h3>
          <div class="input-grid">
            <MobileInput
              v-model="inputValues.filled"
              label="å®å¿ƒè¾“å…¥æ¡†"
              placeholder="è¯·è¾“å…¥å†…å®¹"
              variant="filled"
            />
            <MobileInput
              v-model="inputValues.outlined"
              label="æè¾¹è¾“å…¥æ¡†"
              placeholder="è¯·è¾“å…¥å†…å®¹"
              variant="outlined"
            />
            <MobileInput
              v-model="inputValues.borderless"
              label="æ— è¾¹æ¡†è¾“å…¥æ¡†"
              placeholder="è¯·è¾“å…¥å†…å®¹"
              variant="borderless"
            />
          </div>
        </div>

        <div class="component-showcase">
          <h3>è¾“å…¥æ¡†ç±»å‹</h3>
          <div class="input-grid">
            <MobileInput
              v-model="inputValues.email"
              label="é‚®ç®±"
              type="email"
              placeholder="è¯·è¾“å…¥é‚®ç®±"
              prefix-icon="email"
            />
            <MobileInput
              v-model="inputValues.password"
              label="å¯†ç "
              type="password"
              placeholder="è¯·è¾“å…¥å¯†ç "
              :show-password-toggle="true"
            />
            <MobileInput
              v-model="inputValues.search"
              label="æœç´¢"
              type="search"
              placeholder="æœç´¢å†…å®¹"
              prefix-icon="search"
            />
          </div>
        </div>

        <div class="component-showcase">
          <h3>è¾“å…¥æ¡†çŠ¶æ€</h3>
          <div class="input-grid">
            <MobileInput
              v-model="inputValues.error"
              label="é”™è¯¯çŠ¶æ€"
              placeholder="è¯·è¾“å…¥å†…å®¹"
              error="è¾“å…¥å†…å®¹ä¸ç¬¦åˆè¦æ±‚"
            />
            <MobileInput
              v-model="inputValues.hint"
              label="æç¤ºä¿¡æ¯"
              placeholder="è¯·è¾“å…¥å†…å®¹"
              hint="è¿™æ˜¯ä¸€ä¸ªæç¤ºä¿¡æ¯"
            />
            <MobileInput
              v-model="inputValues.disabled"
              label="ç¦ç”¨çŠ¶æ€"
              placeholder="ç¦ç”¨çš„è¾“å…¥æ¡†"
              disabled
            />
            <MobileInput
              v-model="inputValues.loading"
              label="åŠ è½½çŠ¶æ€"
              placeholder="åŠ è½½ä¸­"
              :loading="true"
            />
          </div>
        </div>
      </section>

      <!-- å¡ç‰‡ç»„ä»¶ -->
      <section class="design-section">
        <h2>ğŸƒ å¡ç‰‡ç»„ä»¶</h2>

        <div class="component-showcase">
          <h3>å¡ç‰‡å˜ä½“</h3>
          <div class="card-grid">
            <MobileCard
              title="æ‚¬æµ®å¡ç‰‡"
              subtitle="è¿™æ˜¯ä¸€ä¸ªæ‚¬æµ®æ ·å¼çš„å¡ç‰‡"
              content="å¡ç‰‡å†…å®¹åŒºåŸŸï¼Œæ”¯æŒè‡ªå®šä¹‰å†…å®¹å’Œæ’æ§½ã€‚"
              variant="elevated"
            />
            <MobileCard
              title="æè¾¹å¡ç‰‡"
              subtitle="è¿™æ˜¯ä¸€ä¸ªæè¾¹æ ·å¼çš„å¡ç‰‡"
              content="é€‚åˆç”¨äºä¿¡æ¯å±•ç¤ºå’Œå†…å®¹åˆ†ç»„ã€‚"
              variant="outlined"
            />
            <MobileCard
              title="å¡«å……å¡ç‰‡"
              subtitle="è¿™æ˜¯ä¸€ä¸ªæ¸å˜èƒŒæ™¯çš„å¡ç‰‡"
              content="é€‚åˆç”¨äºé‡è¦ä¿¡æ¯çš„çªå‡ºæ˜¾ç¤ºã€‚"
              variant="filled"
            />
          </div>
        </div>

        <div class="component-showcase">
          <h3>äº¤äº’å¼å¡ç‰‡</h3>
          <div class="card-grid">
            <MobileCard
              title="å¯ç‚¹å‡»å¡ç‰‡"
              content="ç‚¹å‡»å¡ç‰‡å¯ä»¥è§¦å‘äº‹ä»¶"
              :clickable="true"
              :primary-action="{ label: 'ä¸»è¦æ“ä½œ', handler: () => handleCardAction('primary') }"
              :secondary-action="{ label: 'æ¬¡è¦æ“ä½œ', handler: () => handleCardAction('secondary') }"
              :show-actions="true"
              @click="handleCardClick"
            />
            <MobileCard
              title="åŠ è½½çŠ¶æ€å¡ç‰‡"
              content="å±•ç¤ºåŠ è½½çŠ¶æ€çš„å¡ç‰‡"
              :loading="true"
            />
          </div>
        </div>
      </section>

      <!-- å“åº”å¼æµ‹è¯• -->
      <section class="design-section">
        <h2>ğŸ“± å“åº”å¼æµ‹è¯•</h2>
        <div class="responsive-test">
          <div class="test-description">
            <p>å½“å‰è§†å£å°ºå¯¸: <span class="viewport-size">{{ viewportSize.width }}x{{ viewportSize.height }}</span></p>
            <p>è®¾å¤‡ç±»å‹: <span class="device-type">{{ deviceType }}</span></p>
            <p>è§¦æ‘¸æ”¯æŒ: <span class="touch-support">{{ touchSupport ? 'æ˜¯' : 'å¦' }}</span></p>
          </div>

          <div class="responsive-demo">
            <MobileButton label="å“åº”å¼æŒ‰é’®" size="md" block />
            <MobileCard
              title="å“åº”å¼å¡ç‰‡"
              content="è¿™ä¸ªå¡ç‰‡ä¼šæ ¹æ®è®¾å¤‡å°ºå¯¸è‡ªåŠ¨è°ƒæ•´å¸ƒå±€å’Œé—´è·"
            />
          </div>
        </div>
      </section>
    </div>
  </q-page>
</template>

<script setup lang="ts">
import { ref, computed, onMounted, onUnmounted } from 'vue'
import { MobileButton, MobileCard, MobileInput } from '@/components/base'

// å“åº”å¼æ•°æ®
const inputValues = ref({
  filled: '',
  outlined: '',
  borderless: '',
  email: '',
  password: '',
  search: '',
  error: '',
  hint: '',
  disabled: 'ç¦ç”¨å†…å®¹',
  loading: ''
})

const viewportSize = ref({
  width: 0,
  height: 0
})

// è®¡ç®—å±æ€§
const deviceType = computed(() => {
  const width = viewportSize.value.width
  if (width < 480) return 'æ‰‹æœº'
  if (width < 768) return 'å¤§å±æ‰‹æœº'
  if (width < 1024) return 'å¹³æ¿'
  return 'æ¡Œé¢'
})

const touchSupport = computed(() => {
  return 'ontouchstart' in window
})

// æ–¹æ³•
const handleCardClick = () => {
  console.log('å¡ç‰‡è¢«ç‚¹å‡»')
}

const handleCardAction = (type: string) => {
  console.log(`${type} æ“ä½œè¢«è§¦å‘`)
}

const updateViewportSize = () => {
  viewportSize.value = {
    width: window.innerWidth,
    height: window.innerHeight
  }
}

// ç”Ÿå‘½å‘¨æœŸ
onMounted(() => {
  updateViewportSize()
  window.addEventListener('resize', updateViewportSize)
})

onUnmounted(() => {
  window.removeEventListener('resize', updateViewportSize)
})
</script>

<style scoped lang="scss">
@import '@/styles/variables';
@import '@/styles/mixins';

.design-system-page {
  padding: 0;
}

.design-system-header {
  background: $primary-gradient;
  color: $white;
  padding: $spacing-xl $spacing-md;
  text-align: center;
  margin-bottom: $spacing-xl;

  h1 {
    margin: 0 0 $spacing-sm;
    font-size: $font-size-3xl;
    font-weight: $font-weight-bold;
  }

  .design-system-subtitle {
    margin: 0;
    font-size: $font-size-lg;
    opacity: 0.9;
  }
}

.design-section {
  margin-bottom: $spacing-3xl;

  h2 {
    font-size: $font-size-2xl;
    color: $gray-800;
    margin-bottom: $spacing-lg;
    border-bottom: 2px solid $primary-color;
    padding-bottom: $spacing-sm;
  }

  h3 {
    font-size: $font-size-lg;
    color: $gray-700;
    margin-bottom: $spacing-md;
    font-weight: $font-weight-semibold;
  }
}

// é¢œè‰²ç³»ç»Ÿ
.color-palette {
  display: grid;
  gap: $spacing-xl;

  @include mobile-only {
    gap: $spacing-lg;
  }
}

.color-group {
  h3 {
    margin-bottom: $spacing-sm;
  }
}

.color-swatches {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
  gap: $spacing-md;

  @include mobile-only {
    grid-template-columns: repeat(auto-fit, minmax(100px, 1fr));
    gap: $spacing-sm;
  }
}

.color-swatch {
  text-align: center;

  .color-preview {
    width: 100%;
    height: 60px;
    border-radius: $border-radius-md;
    margin-bottom: $spacing-xs;
    border: 1px solid $gray-200;

    @include mobile-only {
      height: 50px;
    }
  }

  .color-name {
    display: block;
    font-weight: $font-weight-medium;
    font-size: $font-size-sm;
    color: $gray-800;
    margin-bottom: 2px;
  }

  .color-code {
    display: block;
    font-family: $font-family-mono;
    font-size: $font-size-xs;
    color: $gray-600;
  }

  &.primary .color-preview { background: $primary-color; }
  &.secondary .color-preview { background: $secondary-color; }
  &.success .color-preview { background: $success-color; }
  &.warning .color-preview { background: $warning-color; }
  &.danger .color-preview { background: $danger-color; }
}

// ç»„ä»¶å±•ç¤º
.component-showcase {
  margin-bottom: $spacing-xl;
  padding: $spacing-lg;
  background: $bg-secondary;
  border-radius: $border-radius-lg;
  border: 1px solid $gray-200;

  @include mobile-only {
    padding: $spacing-md;
    margin-bottom: $spacing-lg;
  }
}

.button-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
  gap: $spacing-md;
  align-items: center;

  @include mobile-only {
    grid-template-columns: 1fr;
    gap: $spacing-sm;
  }
}

.input-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: $spacing-lg;

  @include mobile-only {
    grid-template-columns: 1fr;
    gap: $spacing-md;
  }
}

.card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: $spacing-lg;

  @include mobile-only {
    grid-template-columns: 1fr;
    gap: $spacing-md;
  }
}

// å“åº”å¼æµ‹è¯•
.responsive-test {
  .test-description {
    background: $gray-50;
    padding: $spacing-md;
    border-radius: $border-radius-md;
    margin-bottom: $spacing-lg;

    p {
      margin: $spacing-xs 0;
      font-size: $font-size-sm;
    }

    .viewport-size,
    .device-type,
    .touch-support {
      font-weight: $font-weight-semibold;
      color: $primary-color;
    }
  }

  .responsive-demo {
    display: flex;
    flex-direction: column;
    gap: $spacing-md;
  }
}

// æš—è‰²æ¨¡å¼æ”¯æŒ
@media (prefers-color-scheme: dark) {
  .design-section h2,
  .design-section h3 {
    color: $gray-100;
  }

  .component-showcase {
    background: $gray-800;
    border-color: $gray-600;
  }

  .color-swatch .color-name {
    color: $gray-200;
  }

  .color-swatch .color-code {
    color: $gray-400;
  }

  .responsive-test .test-description {
    background: $gray-700;
  }
}
</style>
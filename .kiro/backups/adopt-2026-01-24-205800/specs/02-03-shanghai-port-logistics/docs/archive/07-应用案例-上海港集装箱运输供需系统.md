# 上海港集装箱运输供需系统

## 项目概述

上海港集装箱运输供需系统是一个面向集装箱卡车司机和货主的移动端应用，提供智能订单匹配、实时运输追踪和便捷结算功能。系统采用深色主题设计，适合司机在各种光线环境下使用。

### 技术栈

- **前端**: Vue 3.5 + Quasar 2.18 + TypeScript
- **地图**: 高德地图 JS API 2.0
- **状态管理**: Pinia 3.x
- **本地存储**: IndexedDB (Dexie.js)
- **后端**: Moqui Framework 3.1.0

## 1. 设计语言系统

### 1.1 色彩系统

| 类别 | 色值 | 用途 |
|------|------|------|
| **主色** | `#0A1F6C` | 科技蓝，品牌色 |
| **辅助色** | `#00D4AA` | 港口绿，强调色 |
| **行动色** | `#FF4F1E` | 行动橙，主按钮 |
| **成功色** | `#00B365` | 成功状态 |
| **警告色** | `#FFB300` | 警告状态 |
| **错误色** | `#FF3D71` | 错误状态 |

### 1.2 深色主题色彩

| 层级 | 色值 | 用途 |
|------|------|------|
| 页面背景 | `#1C1C1E` | 整体页面背景（最深） |
| 列表背景 | `#2C2C2E` | 列表区域背景（中） |
| 卡片背景 | `#3A3A3C` | 订单卡片背景（浅） |
| 高亮卡片 | 橙色渐变 | 紧急订单高亮 |
| 主要文字 | `#FFFFFF` | 标题、重要信息 |
| 次要文字 | `rgba(255,255,255,0.7)` | 描述、辅助信息 |
| 提示文字 | `rgba(255,255,255,0.5)` | 标签、时间戳 |

### 1.3 字体规范

- **字体**: PingFang SC
- **大标题**: Semibold 34pt
- **卡片标题**: Medium 28pt
- **正文**: Regular 28pt
- **辅助文字**: Regular 24pt
- **行高**: 字号的1.4倍

### 1.4 间距与圆角

- **基准间距**: 20pt
- **间距阶梯**: 8, 12, 20, 32, 48pt
- **大圆角**: 12pt（卡片）
- **小圆角**: 6pt（按钮）

## 2. 核心页面设计

### 2.1 订单大厅（首页）

**功能说明**：
- 顶部状态栏：显示"听单中"状态和当前港区位置
- 筛选栏：支持按港区、车型、沪牌等条件筛选
- 订单列表：无限滚动加载，每页10条

**订单卡片组件**：
```
┌─────────────────────────────────────────┐
│ 🚚 ORD001              运费 ¥1,850     │
├─────────────────────────────────────────┤
│ 洋山港四期    [12.5km]    苏州工业园区  │
├─────────────────────────────────────────┤
│ [沪牌] [40GP]           ⏱ 02:30       │
├─────────────────────────────────────────┤
│   [  拒绝  ]        [  接受订单  ]      │
└─────────────────────────────────────────┘
```

**交互规则**：
- 点击卡片进入订单详情
- 长按卡片弹出菜单（屏蔽货主/收藏路线）
- 下拉刷新获取最新订单

### 2.2 订单执行页

**进度条组件**：
```
(1) 已接单 → (2) 前往堆场 → (3) 确认提箱 → (4) 运输中 → (5) 完成
```

**确认提箱步骤**：
1. 集装箱号：支持扫描或手动输入，自动校验格式
2. 铅封号：手动输入
3. 集装箱照片：需拍摄箱号和箱体

**地图集成**：
- 集成高德地图SDK
- 显示上海港区专属图层（码头、闸口、停车场）
- 绘制优化路线（考虑集卡限高、限重）

### 2.3 我的页面

**个人信息头**：
- 科技蓝背景
- 显示车牌号和等级徽章
- Tab页签：我的订单 / 我的钱包 / 证件管理

**钱包卡片**：
```
可用余额 (元)
¥ 8,650.00
[快速提现]    [充值]
─────────────────────
在途运费：¥ 3,200.00 (2笔)
今日收入：¥ 1,850.00
本周收入：¥ 12,400.00
```

### 2.4 发布订单页（货主端）

**关键组件**：
- 路线选择器：级联选择起运港-目的港
- 箱型选择器：可视化图标选择
- 特殊要求标签：沪牌、液压尾板、熟悉港区
- 发布按钮：根据填写完整度变化状态

## 3. 高级功能模块

### 3.1 地图集成

- **SDK**: 高德地图 JS API 2.0
- **功能**: 路线规划、实时导航、港区图层
- **限制处理**: 自动规避集卡限高、限重路段

### 3.2 推送系统

**推送规则**：
- 根据司机车型筛选匹配订单
- 根据牌照类型（沪牌/非沪牌）筛选
- 只推送距离50公里内的订单

**推送设置**：
- 推送开关
- 距离范围设置
- 推送历史记录

### 3.3 离线处理

**网络异常处理**：
- 页面顶部显示非阻塞式提示条
- 已操作数据本地缓存（IndexedDB）
- 网络恢复后自动提交

**关键操作确认**：
- 抢单、确认送达、支付等使用二次确认弹窗

## 4. 项目结构

```
frontend/moqui-ai-mobile/
├── src/
│   ├── components/
│   │   ├── common/          # 通用组件
│   │   │   ├── BottomNavBar.vue
│   │   │   ├── ConfirmDialog.vue
│   │   │   ├── NetworkStatus.vue
│   │   │   └── FormField.vue
│   │   ├── map/             # 地图组件
│   │   │   ├── AMapContainer.vue
│   │   │   └── POIPopup.vue
│   │   ├── marketplace/     # 业务组件
│   │   │   ├── OrderCard.vue
│   │   │   ├── OrderProgress.vue
│   │   │   └── WalletCard.vue
│   │   └── push/            # 推送组件
│   │       └── PushNotification.vue
│   ├── pages/
│   │   ├── auth/
│   │   │   └── LoginPage.vue
│   │   └── marketplace/
│   │       ├── OrderHall.vue
│   │       ├── OrderDetail.vue
│   │       ├── OrderExecution.vue
│   │       ├── PublishOrder.vue
│   │       ├── MyProfile.vue
│   │       ├── PushSettings.vue
│   │       └── PushHistory.vue
│   ├── services/
│   │   ├── map/             # 地图服务
│   │   ├── push/            # 推送服务
│   │   ├── network/         # 网络/离线服务
│   │   └── error/           # 错误处理服务
│   └── styles/
│       └── shanghai-port-theme.scss
```

## 5. 开发进度

### Phase 1-3（已完成）
- ✅ 设计系统和主题
- ✅ 司机端核心功能
- ✅ 货主端功能

### Phase 4（已完成）
- ✅ 地图集成（高德地图SDK）
- ✅ 推送系统
- ✅ 离线处理
- ✅ 错误处理优化

## 6. 访问方式

- **开发环境**: http://localhost:5173
- **演示账号**: john.doe / moqui

## 7. 设计参考

设计参考截图保存在 `docs/tmp/designRef/` 目录，包括：
- 物流App整体设计概览
- 订单卡片列表设计
- 深色主题实现效果
- 字体和颜色方案参考

# 文档分析和分类操作指南

## 概述

本指南提供了文档类型识别、内容分析和重复性检测的具体操作方法，用于实际执行文档整理和迁移工作。

## 文档类型识别算法

### 识别规则

#### 1. 基于文件名模式识别
```
README* → README类型
*guide* → 技术指南
*config* → 配置文档
*setup* → 配置文档或测试脚本
*troubleshoot* → 故障排查
*case* → 应用案例
*design* → 架构设计
*test* → 测试脚本
*validation* → 测试脚本
*debug* → 测试脚本
*.sh → 可能是测试脚本或配置脚本
*.html (在testing目录) → 测试文件
```

#### 2. 基于内容关键词识别

**技术指南特征**:
- 包含: framework, api, library, installation, configuration
- 包含: getting started, quick start, tutorial, guide, documentation
- 结构: 有安装步骤、配置说明、使用示例

**应用案例特征**:
- 包含: case study, example, implementation, use case, scenario
- 包含: demo, sample, application, project, solution
- 结构: 有业务背景、实现方案、结果分析

**开发指南特征**:
- 包含: development, coding, programming, best practices, standards
- 包含: conventions, workflow, process, methodology
- 结构: 有开发流程、编码规范、质量要求

**架构设计特征**:
- 包含: architecture, design, system, component, module
- 包含: structure, pattern, model, schema, diagram
- 结构: 有架构图、组件说明、设计决策

**故障排查特征**:
- 包含: troubleshooting, problem, issue, error, bug
- 包含: fix, solution, debug, resolve, faq
- 结构: 有问题描述、排查步骤、解决方案

**测试脚本特征**:
- 包含: test, setup, validation, debug, check
- 包含: integration, unit, e2e, performance
- 文件扩展名: .sh, .js, .py, .html (测试文件)
- 结构: 有测试用例、验证步骤、结果检查

#### 3. 基于文档结构识别

**Specs类型文档结构**:
```markdown
# 标题
## 需求/背景
## 设计/方案
## 实施/任务
## 结果/总结
```

**Steering类型文档结构**:
```markdown
# 标题
## 概述/原则
## 标准/规范
## 最佳实践
## 示例/参考
```

## 内容分析和提取功能

### 文档价值评估

#### 评估维度
1. **内容质量** (权重: 30%)
   - 结构完整性: 有清晰的标题层次
   - 内容丰富度: 包含代码示例、图表、链接
   - 可读性: 语言清晰、逻辑连贯

2. **唯一性** (权重: 25%)
   - 信息独特性: 不与其他文档重复
   - 专业深度: 提供独特见解或方案

3. **相关性** (权重: 25%)
   - 技术相关性: 与当前技术栈匹配
   - 业务相关性: 与项目目标一致
   - 时效性: 信息是否过时

4. **维护性** (权重: 20%)
   - 更新频率: 最近更新时间
   - 维护状态: 是否有人负责维护
   - 引用情况: 被其他文档引用的频率

#### 评分标准
- **90-100分**: 高价值文档，必须保留并迁移
- **70-89分**: 中等价值文档，建议迁移整理
- **50-69分**: 一般价值文档，可选择性处理
- **30-49分**: 低价值文档，建议归档
- **0-29分**: 无价值文档，建议删除

### 元数据提取规则

#### 自动提取项目
1. **标题**: 第一个一级标题 (`# 标题`)
2. **作者**: 查找 `author:`, `作者:`, `by:` 等标识
3. **日期**: 查找日期格式 `YYYY-MM-DD`, `最后更新`, `创建时间`
4. **标签**: 查找 `tags:`, `关键词:`, `keywords:` 等
5. **版本**: 查找 `version:`, `v1.0`, `版本:` 等
6. **文件信息**: 文件大小、修改时间、行数

#### 内容特征提取
1. **代码块数量**: 统计 ``` 代码块
2. **图片数量**: 统计 ![图片] 引用
3. **链接数量**: 统计 [链接](url) 引用
4. **章节数量**: 统计各级标题数量
5. **字数统计**: 中英文字符统计
6. **语言检测**: 基于字符特征判断主要语言

## 重复性检测机制

### 检测算法

#### 1. 精确重复检测
- **文件哈希**: 计算文件MD5/SHA256
- **内容对比**: 逐字符比较
- **结构对比**: 标题结构完全一致

#### 2. 近似重复检测
- **相似度阈值**: 80%以上视为近似重复
- **关键词重叠**: 核心关键词重叠度 > 70%
- **结构相似**: 章节结构相似度 > 75%

#### 3. 内容重叠检测
- **段落重叠**: 相同段落 > 50%
- **代码重叠**: 相同代码块 > 60%
- **概念重叠**: 核心概念重叠 > 65%

### 重复处理策略

#### 精确重复
- **保留策略**: 保留最新版本或最完整版本
- **删除策略**: 删除其他重复副本
- **记录策略**: 记录删除的文件路径和原因

#### 近似重复
- **合并策略**: 合并互补内容，创建完整版本
- **选择策略**: 选择质量最高的版本保留
- **标记策略**: 标记为需要人工审核

#### 内容重叠
- **拆分策略**: 提取独特内容，合并共同部分
- **引用策略**: 建立文档间的引用关系
- **重构策略**: 重新组织内容结构

## 实际操作流程

### 第一步: 文档扫描和分类

```bash
# 扫描docs目录
find docs/ -name "*.md" -type f > document_list.txt

# 分析每个文档
for file in $(cat document_list.txt); do
    echo "分析文档: $file"
    # 1. 提取基本信息
    # 2. 识别文档类型
    # 3. 评估文档价值
    # 4. 记录分析结果
done
```

### 第二步: 重复性检测

```bash
# 检测重复文档
# 1. 计算文件哈希
# 2. 比较内容相似度
# 3. 识别重复组
# 4. 生成处理建议
```

### 第三步: 迁移计划生成

```bash
# 生成迁移计划
# 1. 确定目标位置
# 2. 规划迁移顺序
# 3. 识别依赖关系
# 4. 制定时间表
```

## 分析结果记录

### 文档分析报告模板

```markdown
# 文档分析报告

## 基本信息
- 文件路径: docs/example.md
- 文件大小: 1024 bytes
- 创建时间: 2024-01-01
- 修改时间: 2024-12-01
- 行数: 100

## 内容分析
- 文档类型: 技术指南
- 主要语言: 中文
- 标题数量: 15
- 代码块数量: 5
- 图片数量: 2
- 链接数量: 8

## 价值评估
- 内容质量: 85分
- 唯一性: 90分
- 相关性: 80分
- 维护性: 70分
- 总分: 81分
- 建议: 迁移到steering目录

## 迁移建议
- 目标位置: .kiro/steering/technical-guide.md
- 处理方式: 整合到现有文档
- 优先级: 高
- 依赖关系: 无
```

### 重复检测报告模板

```markdown
# 重复文档检测报告

## 重复组1: 开发指南
- 主文档: docs/01-开发指南.md (评分: 85)
- 重复文档: docs/development-guide.md (评分: 70)
- 相似度: 78%
- 处理建议: 合并到主文档，删除重复文档

## 重复组2: API文档
- 文档1: docs/api-guide.md (评分: 80)
- 文档2: docs/rest-api.md (评分: 75)
- 相似度: 65%
- 处理建议: 人工审核，可能需要拆分合并
```

## 质量控制

### 分析准确性验证
1. **抽样检查**: 随机抽取10%文档进行人工验证
2. **边界测试**: 测试边界情况的分类准确性
3. **反馈循环**: 根据验证结果调整分析规则

### 处理结果验证
1. **完整性检查**: 确保重要内容不丢失
2. **一致性检查**: 确保分类结果一致
3. **链接检查**: 确保文档间引用正确

---

**文档版本**: v1.0  
**最后更新**: 2025年1月13日  
**适用范围**: 文档分析和整理工作  
**审批状态**: 待审批